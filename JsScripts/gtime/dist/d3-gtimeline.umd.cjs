(function(N,H){typeof exports=="object"&&typeof module<"u"?H(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],H):(N=typeof globalThis<"u"?globalThis:N||self,H(N.d3=N.d3||{},N.d3,N.dayjs))})(this,function(N,H,G){"use strict";function Tt(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const g=Tt(H),Et="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function Z(t){g.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(Et);const e=g.select("body").append("div").attr("class","tooltip").style("opacity",0);return e.show=function(n){e.transition().duration(100).style("opacity",.95),e.html(t.apply(null,arguments)).style("left",n.pageX+"px").style("top",n.pageY-28+"px")},e.hide=function(n){e.transition().duration(100).style("opacity",0)},e}function Ft(t){return g.max(t.nodes().map(e=>e.getComputedTextLength()))}function Dt(t){return function(e){return e.length>t?e.slice(0,t-1)+"…":e}}const V=1,Nt=2;function nt(t,e){let n=["#FFF","#EEE"],i=g.scaleOrdinal(n),r=5,s,a="#AAA",l=40,c=3e3,o;function u(p){let k=e.domain(),S=Z(d=>d),M=g.scaleOrdinal(n),E=g.scaleOrdinal(n.reverse()),b=Dt(l),T=p.selectAll(".row").data(k,e).order(),m=T.enter().append("g").attr("class","row"),_=T.exit(),y=T.select("text");T=T.merge(m).attr("transform",d=>"translate(0,"+e(d)+")"),_.remove(),m.append("rect").attr("y",.5).attr("width",c).attr("height",e.bandwidth()).attr("stroke",a).attr("stroke-width",.75).attr("fill",M),m.append("path").attr("stroke",E),y=y.merge(m.append("text").attr("y",e.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(d,h){g.select(this).text()!=h&&S.show(h)}).on("mouseout",S.hide)).text(b),o===void 0&&(o=Ft(y)+2*r,o=t===V?c-o:o),s=t===V?[0,o]:[o,c],y.attr("text-anchor",t===V?"start":"end").attr("dx",t===V?r:-r).attr("x",o);const A=function(d,h){o=Math.max(10,Math.min(c-10,o+d.dx)),g.select(this).attr("d","M"+o+",0.5V"+e.range()[1]),y.attr("x",o),s=t===V?[0,o]:[o,c],p.dispatch("offset",{detail:{offset:o}})};p.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",a).attr("stroke-width",1.75).attr("d","M"+(o+.5)+",0.5V"+e.range()[1]).style("cursor","ew-resize").call(g.drag().on("drag",A))}return u.draw_ticks=function(p,k){p.selectAll(".row").select("path").attr("d",k.map(S=>"M"+S+",1v"+(e.bandwidth()-1)).join(""))},u.scale=function(p){return arguments.length?(e=p,u):e},u.width=function(p){return arguments.length?(c=p,u):c},u.colors=function(p){return arguments.length?(n=p,u):n},u.padding=function(p){return arguments.length?(r=p,u):r},u.range=function(p){return arguments.length?(s=p,u):s},u.trim=function(p){return arguments.length?(l=p,u):l},u.offset=function(p){return arguments.length?(o=p,u):o},u.colorscale=function(p){return arguments.length?(i=p,u):i},u}function rt(t){return nt(Nt,t)}function it(t){return nt(V,t)}var st=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ot(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var at={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(st,function(){var n,i,r=1e3,s=6e4,a=36e5,l=864e5,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,p=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,k={years:o,months:u,days:l,hours:a,minutes:s,seconds:r,milliseconds:1,weeks:6048e5},S=function(d){return d instanceof y},M=function(d,h,f){return new y(d,f,h.$l)},E=function(d){return i.p(d)+"s"},b=function(d){return d<0},T=function(d){return b(d)?Math.ceil(d):Math.floor(d)},m=function(d){return Math.abs(d)},_=function(d,h){return d?b(d)?{negative:!0,format:""+m(d)+h}:{negative:!1,format:""+d+h}:{negative:!1,format:""}},y=function(){function d(f,v,$){var w=this;if(this.$d={},this.$l=$,f===void 0&&(this.$ms=0,this.parseFromMilliseconds()),v)return M(f*k[E(v)],this);if(typeof f=="number")return this.$ms=f,this.parseFromMilliseconds(),this;if(typeof f=="object")return Object.keys(f).forEach(function(D){w.$d[E(D)]=f[D]}),this.calMilliseconds(),this;if(typeof f=="string"){var C=f.match(p);if(C){var F=C.slice(2).map(function(D){return D!=null?Number(D):0});return this.$d.years=F[0],this.$d.months=F[1],this.$d.weeks=F[2],this.$d.days=F[3],this.$d.hours=F[4],this.$d.minutes=F[5],this.$d.seconds=F[6],this.calMilliseconds(),this}}return this}var h=d.prototype;return h.calMilliseconds=function(){var f=this;this.$ms=Object.keys(this.$d).reduce(function(v,$){return v+(f.$d[$]||0)*k[$]},0)},h.parseFromMilliseconds=function(){var f=this.$ms;this.$d.years=T(f/o),f%=o,this.$d.months=T(f/u),f%=u,this.$d.days=T(f/l),f%=l,this.$d.hours=T(f/a),f%=a,this.$d.minutes=T(f/s),f%=s,this.$d.seconds=T(f/r),f%=r,this.$d.milliseconds=f},h.toISOString=function(){var f=_(this.$d.years,"Y"),v=_(this.$d.months,"M"),$=+this.$d.days||0;this.$d.weeks&&($+=7*this.$d.weeks);var w=_($,"D"),C=_(this.$d.hours,"H"),F=_(this.$d.minutes,"M"),D=this.$d.seconds||0;this.$d.milliseconds&&(D+=this.$d.milliseconds/1e3,D=Math.round(1e3*D)/1e3);var Y=_(D,"S"),P=f.negative||v.negative||w.negative||C.negative||F.negative||Y.negative,W=C.format||F.format||Y.format?"T":"",q=(P?"-":"")+"P"+f.format+v.format+w.format+W+C.format+F.format+Y.format;return q==="P"||q==="-P"?"P0D":q},h.toJSON=function(){return this.toISOString()},h.format=function(f){var v=f||"YYYY-MM-DDTHH:mm:ss",$={Y:this.$d.years,YY:i.s(this.$d.years,2,"0"),YYYY:i.s(this.$d.years,4,"0"),M:this.$d.months,MM:i.s(this.$d.months,2,"0"),D:this.$d.days,DD:i.s(this.$d.days,2,"0"),H:this.$d.hours,HH:i.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:i.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:i.s(this.$d.seconds,2,"0"),SSS:i.s(this.$d.milliseconds,3,"0")};return v.replace(c,function(w,C){return C||String($[w])})},h.as=function(f){return this.$ms/k[E(f)]},h.get=function(f){var v=this.$ms,$=E(f);return $==="milliseconds"?v%=1e3:v=$==="weeks"?T(v/k[$]):this.$d[$],v||0},h.add=function(f,v,$){var w;return w=v?f*k[E(v)]:S(f)?f.$ms:M(f,this).$ms,M(this.$ms+w*($?-1:1),this)},h.subtract=function(f,v){return this.add(f,v,!0)},h.locale=function(f){var v=this.clone();return v.$l=f,v},h.clone=function(){return M(this.$ms,this)},h.humanize=function(f){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!f)},h.valueOf=function(){return this.asMilliseconds()},h.milliseconds=function(){return this.get("milliseconds")},h.asMilliseconds=function(){return this.as("milliseconds")},h.seconds=function(){return this.get("seconds")},h.asSeconds=function(){return this.as("seconds")},h.minutes=function(){return this.get("minutes")},h.asMinutes=function(){return this.as("minutes")},h.hours=function(){return this.get("hours")},h.asHours=function(){return this.as("hours")},h.days=function(){return this.get("days")},h.asDays=function(){return this.as("days")},h.weeks=function(){return this.get("weeks")},h.asWeeks=function(){return this.as("weeks")},h.months=function(){return this.get("months")},h.asMonths=function(){return this.as("months")},h.years=function(){return this.get("years")},h.asYears=function(){return this.as("years")},d}(),A=function(d,h,f){return d.add(h.years()*f,"y").add(h.months()*f,"M").add(h.days()*f,"d").add(h.hours()*f,"h").add(h.minutes()*f,"m").add(h.seconds()*f,"s").add(h.milliseconds()*f,"ms")};return function(d,h,f){n=f,i=f().$utils(),f.duration=function(w,C){var F=f.locale();return M(w,{$l:F},C)},f.isDuration=S;var v=h.prototype.add,$=h.prototype.subtract;h.prototype.add=function(w,C){return S(w)?A(this,w,1):v.bind(this)(w,C)},h.prototype.subtract=function(w,C){return S(w)?A(this,w,-1):$.bind(this)(w,C)}}})})(at);var Yt=at.exports;const Ot=ot(Yt);var lt={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(st,function(){return function(n,i,r){n=n||{};var s=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(o,u,p,k){return s.fromToBase(o,u,p,k)}r.en.relativeTime=a,s.fromToBase=function(o,u,p,k,S){for(var M,E,b,T=p.$locale().relativeTime||a,m=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],_=m.length,y=0;y<_;y+=1){var A=m[y];A.d&&(M=k?r(o).diff(p,A.d,!0):p.diff(o,A.d,!0));var d=(n.rounding||Math.round)(Math.abs(M));if(b=M>0,d<=A.r||!A.r){d<=1&&y>0&&(A=m[y-1]);var h=T[A.l];S&&(d=S(""+d)),E=typeof h=="string"?h.replace("%d",d):h(d,u,A.l,b);break}}if(u)return E;var f=b?T.future:T.past;return typeof f=="function"?f(E):f.replace("%s",E)},s.to=function(o,u){return l(o,u,this,!0)},s.from=function(o,u){return l(o,u,this)};var c=function(o){return o.$u?r.utc():r()};s.toNow=function(o){return this.to(c(this),o)},s.fromNow=function(o){return this.from(c(this),o)}}})})(lt);var Bt=lt.exports;const Rt=ot(Bt);G.extend(Ot),G.extend(Rt);function ct(t,e){return G.duration(e-t).humanize()}function K(){const t=Array.prototype.slice.call(arguments,0);return function(e){return t.reduce((n,i)=>i(n),e)}}function U(t){return function(e){return t===void 0?e:e[t]}}var J="http://www.w3.org/1999/xhtml";const ut={svg:"http://www.w3.org/2000/svg",xhtml:J,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ft(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ut.hasOwnProperty(e)?{space:ut[e],local:t}:t}function Pt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===J&&e.documentElement.namespaceURI===J?e.createElement(t):e.createElementNS(n,t)}}function qt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ht(t){var e=ft(t);return(e.local?qt:Pt)(e)}function Ht(){}function dt(t){return t==null?Ht:function(){return this.querySelector(t)}}function Lt(t){typeof t!="function"&&(t=dt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,l=i[r]=new Array(a),c,o,u=0;u<a;++u)(c=s[u])&&(o=t.call(c,c.__data__,u,s))&&("__data__"in c&&(o.__data__=c.__data__),l[u]=o);return new O(i,this._parents)}function pt(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Vt(){return[]}function zt(t){return t==null?Vt:function(){return this.querySelectorAll(t)}}function It(t){return function(){return pt(t.apply(this,arguments))}}function Wt(t){typeof t=="function"?t=It(t):t=zt(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var a=e[s],l=a.length,c,o=0;o<l;++o)(c=a[o])&&(i.push(t.call(c,c.__data__,o,a)),r.push(c));return new O(i,r)}function jt(t){return function(){return this.matches(t)}}function mt(t){return function(e){return e.matches(t)}}var Ut=Array.prototype.find;function Xt(t){return function(){return Ut.call(this.children,t)}}function Gt(){return this.firstElementChild}function Zt(t){return this.select(t==null?Gt:Xt(typeof t=="function"?t:mt(t)))}var Kt=Array.prototype.filter;function Jt(){return Array.from(this.children)}function Qt(t){return function(){return Kt.call(this.children,t)}}function te(t){return this.selectAll(t==null?Jt:Qt(typeof t=="function"?t:mt(t)))}function ee(t){typeof t!="function"&&(t=jt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,l=i[r]=[],c,o=0;o<a;++o)(c=s[o])&&t.call(c,c.__data__,o,s)&&l.push(c);return new O(i,this._parents)}function gt(t){return new Array(t.length)}function ne(){return new O(this._enter||this._groups.map(gt),this._parents)}function X(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}X.prototype={constructor:X,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function re(t){return function(){return t}}function ie(t,e,n,i,r,s){for(var a=0,l,c=e.length,o=s.length;a<o;++a)(l=e[a])?(l.__data__=s[a],i[a]=l):n[a]=new X(t,s[a]);for(;a<c;++a)(l=e[a])&&(r[a]=l)}function se(t,e,n,i,r,s,a){var l,c,o=new Map,u=e.length,p=s.length,k=new Array(u),S;for(l=0;l<u;++l)(c=e[l])&&(k[l]=S=a.call(c,c.__data__,l,e)+"",o.has(S)?r[l]=c:o.set(S,c));for(l=0;l<p;++l)S=a.call(t,s[l],l,s)+"",(c=o.get(S))?(i[l]=c,c.__data__=s[l],o.delete(S)):n[l]=new X(t,s[l]);for(l=0;l<u;++l)(c=e[l])&&o.get(k[l])===c&&(r[l]=c)}function oe(t){return t.__data__}function ae(t,e){if(!arguments.length)return Array.from(this,oe);var n=e?se:ie,i=this._parents,r=this._groups;typeof t!="function"&&(t=re(t));for(var s=r.length,a=new Array(s),l=new Array(s),c=new Array(s),o=0;o<s;++o){var u=i[o],p=r[o],k=p.length,S=le(t.call(u,u&&u.__data__,o,i)),M=S.length,E=l[o]=new Array(M),b=a[o]=new Array(M),T=c[o]=new Array(k);n(u,p,E,b,T,S,e);for(var m=0,_=0,y,A;m<M;++m)if(y=E[m]){for(m>=_&&(_=m+1);!(A=b[_])&&++_<M;);y._next=A||null}}return a=new O(a,i),a._enter=l,a._exit=c,a}function le(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ce(){return new O(this._exit||this._groups.map(gt),this._parents)}function ue(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function fe(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),l=new Array(r),c=0;c<a;++c)for(var o=n[c],u=i[c],p=o.length,k=l[c]=new Array(p),S,M=0;M<p;++M)(S=o[M]||u[M])&&(k[M]=S);for(;c<r;++c)l[c]=n[c];return new O(l,this._parents)}function he(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],a;--r>=0;)(a=i[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function de(t){t||(t=pe);function e(p,k){return p&&k?t(p.__data__,k.__data__):!p-!k}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var a=n[s],l=a.length,c=r[s]=new Array(l),o,u=0;u<l;++u)(o=a[u])&&(c[u]=o);c.sort(e)}return new O(r,this._parents).order()}function pe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function me(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ge(){return Array.from(this)}function ye(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null}function _e(){let t=0;for(const e of this)++t;return t}function we(){return!this.node()}function ve(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,a=r.length,l;s<a;++s)(l=r[s])&&t.call(l,l.__data__,s,r);return this}function xe(t){return function(){this.removeAttribute(t)}}function be(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ae(t,e){return function(){this.setAttribute(t,e)}}function $e(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Se(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ke(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Me(t,e){var n=ft(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?be:xe:typeof e=="function"?n.local?ke:Se:n.local?$e:Ae)(n,e))}function yt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ce(t){return function(){this.style.removeProperty(t)}}function Te(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ee(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Fe(t,e,n){return arguments.length>1?this.each((e==null?Ce:typeof e=="function"?Ee:Te)(t,e,n??"")):De(this.node(),t)}function De(t,e){return t.style.getPropertyValue(e)||yt(t).getComputedStyle(t,null).getPropertyValue(e)}function Ne(t){return function(){delete this[t]}}function Ye(t,e){return function(){this[t]=e}}function Oe(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Be(t,e){return arguments.length>1?this.each((e==null?Ne:typeof e=="function"?Oe:Ye)(t,e)):this.node()[t]}function _t(t){return t.trim().split(/^|\s+/)}function Q(t){return t.classList||new wt(t)}function wt(t){this._node=t,this._names=_t(t.getAttribute("class")||"")}wt.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function vt(t,e){for(var n=Q(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function xt(t,e){for(var n=Q(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Re(t){return function(){vt(this,t)}}function Pe(t){return function(){xt(this,t)}}function qe(t,e){return function(){(e.apply(this,arguments)?vt:xt)(this,t)}}function He(t,e){var n=_t(t+"");if(arguments.length<2){for(var i=Q(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?qe:e?Re:Pe)(n,e))}function Le(){this.textContent=""}function Ve(t){return function(){this.textContent=t}}function ze(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Ie(t){return arguments.length?this.each(t==null?Le:(typeof t=="function"?ze:Ve)(t)):this.node().textContent}function We(){this.innerHTML=""}function je(t){return function(){this.innerHTML=t}}function Ue(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Xe(t){return arguments.length?this.each(t==null?We:(typeof t=="function"?Ue:je)(t)):this.node().innerHTML}function Ge(){this.nextSibling&&this.parentNode.appendChild(this)}function Ze(){return this.each(Ge)}function Ke(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Je(){return this.each(Ke)}function Qe(t){var e=typeof t=="function"?t:ht(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function tn(){return null}function en(t,e){var n=typeof t=="function"?t:ht(t),i=e==null?tn:typeof e=="function"?e:dt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function nn(){var t=this.parentNode;t&&t.removeChild(this)}function rn(){return this.each(nn)}function sn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function on(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function an(t){return this.select(t?on:sn)}function ln(t){return arguments.length?this.property("__data__",t):this.node().__data__}function cn(t){return function(e){t.call(this,e,this.__data__)}}function un(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function fn(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function hn(t,e,n){return function(){var i=this.__on,r,s=cn(e);if(i){for(var a=0,l=i.length;a<l;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function dn(t,e,n){var i=un(t+""),r,s=i.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,o=l.length,u;c<o;++c)for(r=0,u=l[c];r<s;++r)if((a=i[r]).type===u.type&&a.name===u.name)return u.value}return}for(l=e?hn:fn,r=0;r<s;++r)this.each(l(i[r],e,n));return this}function bt(t,e,n){var i=yt(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function pn(t,e){return function(){return bt(this,t,e)}}function mn(t,e){return function(){return bt(this,t,e.apply(this,arguments))}}function gn(t,e){return this.each((typeof e=="function"?mn:pn)(t,e))}function*yn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,a;r<s;++r)(a=i[r])&&(yield a)}var _n=[null];function O(t,e){this._groups=t,this._parents=e}function wn(){return this}O.prototype={constructor:O,select:Lt,selectAll:Wt,selectChild:Zt,selectChildren:te,filter:ee,data:ae,enter:ne,exit:ce,join:ue,merge:fe,selection:wn,order:he,sort:de,call:me,nodes:ge,node:ye,size:_e,empty:we,each:ve,attr:Me,style:Fe,property:Be,classed:He,text:Ie,html:Xe,raise:Ze,lower:Je,append:Qe,insert:en,remove:rn,clone:an,datum:ln,on:dn,dispatch:gn,[Symbol.iterator]:yn};function vn(t){return typeof t=="string"?new O([document.querySelectorAll(t)],[document.documentElement]):new O([pt(t)],_n)}const xn=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function bn(t){const e=window.getComputedStyle(t,null).getPropertyValue("font-size");return parseFloat(e)}function An(t){return t.r*.299+t.g*.587+t.b*.114}function $n(t){return An(t)>165}function Sn(t){return $n(g.color(t))?"black":"white"}function At(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}${n}${i}`}function I(t,e){return"translate("+t+","+e+")"}function $t(t,e){vn(`g.task.${t}`).each(function(n){g.select(this).style("display",e)})}function kn(){document.querySelectorAll('g.task[class*=" --"]').forEach(function(e){e.style.display="none"})}function Mn(t,e){let i=t.getAttribute("transform").match(/translate\(([\d.-]+),([\d.-]+)\)/);if(i){let r=parseFloat(i[1]),s=parseFloat(i[2]);s+=e,t.setAttribute("transform",`translate(${r},${s})`)}}function St(t,e,n){const r=g.select(t).attr("class");let s=!1;e.selectAll("g.row").each(function(a){const c=g.select(this).attr("class");c==r?s=!0:s&&(Mn(this,n),Cn(c.split(" ")[1],n))})}function Cn(t,e){document.querySelectorAll(`g.task.${t} rect`).forEach(function(r){let a=parseFloat(r.getAttribute("y"))+e;r.setAttribute("y",a)}),document.querySelectorAll(`g.task.${t} text`).forEach(function(r){let a=parseFloat(r.getAttribute("y"))+e;r.setAttribute("y",a)})}function kt(t,e,n){const r=g.select(t).attr("class"),s=[];let a=!1,l=!1;return e.selectAll("g.row").each(function(c){const u=g.select(this).attr("class");u==r?a=!0:a&&u.split(" ")[2]=="timelineheader"?l=!0:a&&!l&&s.push(u.split(" ")[1])}),console.log(r.split(" ")[1]),n=="block"?($t(r.split(" ")[1],"none"),console.log("You pressed plus")):(console.log("You pressed minus"),$t(r.split(" ")[1],"block")),s.forEach(function(c){document.querySelectorAll(`.${c}`).forEach(function(u){u.style.display=n})}),s.length*38}function Mt(t){const e=document.querySelector('path[stroke-width="1.75"]');if(e){let i=e.getAttribute("d").match(/M([\d.-]+),([\d.-]+)V([\d.-]+)/);if(i){let r=parseFloat(i[1]),s=parseFloat(i[2]),l=parseFloat(i[3])+t;e.setAttribute("d",`M${r},${s}V${l}`)}}else console.error('Path with stroke-width="1.75" not found.')}function Ct(t){const e=document.querySelector("g.x.axis.bottom-axis");if(e){let i=e.getAttribute("transform").match(/translate\(([\d.-]+),([\d.-]+)\)/);if(i){let r=parseFloat(i[1]),a=parseFloat(i[2])+t;e.setAttribute("transform",`translate(${r},${a})`)}}else console.error("x axis bottom-axis not found.")}function Tn(){let t=xn,e=5,n=2,i=!1,r=!1,s,a,l=0,c=U(0),o=U(1),u=U(2),p=U(3);function k(m,_){const y=m.select("text"),A=m.select("rect"),d=A.attr("width")-2*e,h=o(_);y.text(h);let f=y.node().getComputedTextLength();if(f>d){const v=d<0?0:d/f,$=Math.floor(h.length*v);y.text($>2?h.slice(0,$-2)+"…":"")}}function S(m,_,y){const A=m.select("text").node(),d=A.getBBox(),h=y.scale().domain().indexOf(c(_)),f=y.colorscale()(h),v=m.selectAll("rect.bckg").data([_]).join("rect").attr("class","bckg").attr("fill",f).attr("x",d.x-e+n).attr("y",d.y-2).attr("width",d.width+e-n).attr("height",d.height);m.node().insertBefore(v.node(),A)}function M(m,_){m.each(function(y,A){const d=g.select(this.parentNode);p(y)-u(y)?k(d,y):S(d,y,_)})}function E(m){return function(_,y){g.active(this).tween("text",function(){return function(A){M(g.select(this),m)}})}}function b(m){const _=m.datum(),y=new Set(g.map(_,c)),A=new Z(T),d=g.scaleOrdinal(t);s=s||[g.min(_,u),g.max(_,p)],r&&(s=g.extent(s.concat(new Date))),m.each(function(h){const f=a||this.getBoundingClientRect().width,v=y.size*(bn(this)+4*e),$=g.scaleBand().domain(y).range([0,v]),w=g.scaleTime().domain(s),C=(i?it:rt)($).width(f),F=g.select(this).selectAll("svg").data([1]).join("svg");F.attr("class","timeline").attr("width",f).attr("height",v+40);const D=F.append("g").attr("transform","translate(0,20)"),Y=D.append("g").attr("class","y axis").call(C);Y.selectAll("text").attr("text-anchor",function(x){return x.startsWith(" •")?"middle":"end"}).attr("x",function(x){return x.startsWith(" •")?167:332.5}).style("cursor","pointer").style("font-weight",function(x){return x.startsWith(" •")?"bold":"normal"}).style("background","none").on("click",function(x,B){const z=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${B.replace(/ • /g,"").replace(" ","%20")}%22`;window.open(z,"_blank")}),Y.selectAll("g.row").each(function(x){const B=g.select(this).datum();g.select(this).classed(g.select(this).datum().replace(/•/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,""),!0),B.startsWith(" •")&&g.select(this).classed("timelineheader",!0).append("text").attr("x",320.5).attr("y",25).text("-").style("text-anchor","end").style("cursor","pointer").style("font-size","30px").attr("fill","black").style("-ms-user-select","none").style("-webkit-user-select","none").style("user-select","none")}),Y.selectAll("g.row.timelineheader text").on("click",function(x,B){const j=g.select(this).text();if(j==="+"){let R=kt(this.parentNode,Y,"block");St(this.parentNode,Y,R),Mt(R),Ct(R),g.select(this).text()==="+"?g.select(this).text("-").style("font-size","30px"):g.select(this).text("+")}else if(j==="-"){let R=kt(this.parentNode,Y,"none");St(this.parentNode,Y,-R),Mt(-R),Ct(-R),g.select(this).text()==="-"?g.select(this).text("+").style("font-size","20px"):g.select(this).text("-")}else{const et=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${B.replace(/ • /g,"").replace(" ","%20")}%22`;window.open(et,"_blank")}});let P=C.range();w.range([P[0]+e,P[1]-e]).clamp(!0);const W=g.axisBottom(w),q=D.append("g").attr("class","x axis").attr("transform",I(0,0)).call(W);q.selectAll(".tick text").attr("dy","-1.5em"),q.selectAll(".tick line").attr("y2","-5");const En=g.axisBottom(w);F.append("g").attr("class","x axis bottom-axis").attr("transform",I(0,v+20)).call(En).selectAll(".tick line").attr("y2","5"),Y.on("offset",()=>{P=C.range(),w.range([P[0]+e,P[1]-e]).clamp(!0),W.ticks(Math.min((P[1]-P[0])/70,10)),q.call(W),L.attr("transform",x=>I(w(u(x)),$(c(x)))).selectAll("rect").attr("width",x=>w(p(x))-w(u(x))||n).call(x=>M(x,C)),Y.call(C.draw_ticks,w.ticks().map(w))}),q.select(".domain").remove(),q.selectAll(".tick line").attr("stroke","#AAA");const Fn=w.ticks().map(w);Y.call(C.draw_ticks,Fn);let L=D.selectAll("g.task").data(h);L.exit().remove();const tt=L.enter().append("g").classed("task",!0);tt.each(function(x){const B=c(x).replace(/•/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");g.select(this).classed(B,!0)}).append("rect").style("opacity",1).attr("y",e).style("cursor","pointer").attr("height",$.bandwidth()-2*e).on("mouseover",A.show).on("mouseout",A.hide).on("click",function(x,B){var j=String(B[1]),R=j.replace(" ","%20"),z=B[2],et=At(z),Dn=B[3],Nn=At(Dn),Yn="https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22"+R+"%22%20%2Bdate_when%3A%5B"+et+"%20TO%20"+Nn+"%5D%7Crows=20%7Cstart=0%7Chl=true%7Chl.fl=text_merge%7Csort=date_when%20asc%7Cff=person_keyword;subject%7Cfl=id%20index%20title%20filename%20resource_group_name%20date_when%20date_to%20author%20recipient%20person_keyword%20subject%20doc_beginning";window.open(Yn,"_blank")}).style("fill",K(o,d)),tt.append("text").attr("text-anchor","start").attr("fill",x=>p(x)-u(x)?K(o,d,Sn)(x):"black").attr("pointer-events","none").attr("dx",e).attr("y",$.bandwidth()/2).attr("dy","0.32em").text(o),L=L.merge(tt),L.attr("transform",x=>I(P[0],$(c(x)))).selectAll("rect").attr("width",0),L.transition().duration(l).attr("transform",x=>I(w(u(x)),$(c(x)))).selectAll("rect").attr("width",x=>w(p(x))-w(u(x))||n).on("start",E(C)),r&&D.append("path").attr("stroke","red").attr("d","M"+w(new Date)+",0.5V"+v)}),kn()}return b.dates=function(m){return arguments.length?(s=m,b):s},b.width=function(m){return arguments.length?(a=m,b):a},b.today=function(m){return arguments.length?(r=m,b):r},b.colors=function(m){return arguments.length?(t=m,b):t},b.padding=function(m){return arguments.length?(e=m,b):e},b.milestone_width=function(m){return arguments.length?(n=m,b):n},b.reversed=function(m){return arguments.length?(i=m,b):i},b.duration=function(m){return arguments.length?(l=m,b):l},b;function T(m,_){const y=K(g.isoParse,g.timeFormat("%Y-%m-%d")),A=`<b>${o(_)}</b><hr style="margin: 2px 0 2px 0">${y(u(_))}`,d=p(_)-u(_)?` - ${y(p(_))}<br>${ct(u(_),p(_))}`:"";return A+d}}N.durationFormat=ct,N.timeline=Tn,N.timelineAxisLeft=rt,N.timelineAxisRight=it,N.tooltip=Z,Object.keys(H).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(N,t)&&Object.defineProperty(N,t,{enumerable:!0,get:()=>H[t]})}),Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})});
