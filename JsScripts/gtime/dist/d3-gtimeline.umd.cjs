(function(j,F){typeof exports=="object"&&typeof module<"u"?F(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],F):(j=typeof globalThis<"u"?globalThis:j||self,F(j.d3=j.d3||{},j.d3,j.dayjs))})(this,function(j,F,V){"use strict";function rt(e){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const c in e)if(c!=="default"){const f=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(r,c,f.get?f:{enumerable:!0,get:()=>e[c]})}}return r.default=e,Object.freeze(r)}const w=rt(F),it="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function G(e){w.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(it);const r=w.select("body").append("div").attr("class","tooltip").style("opacity",0);return r.show=function(c){r.transition().duration(100).style("opacity",.95),r.html(e.apply(null,arguments)).style("left",c.pageX+"px").style("top",c.pageY-28+"px")},r.hide=function(c){r.transition().duration(100).style("opacity",0)},r}function st(e){return w.max(e.nodes().map(r=>r.getComputedTextLength()))}function ot(e){return function(r){return r.length>e?r.slice(0,e-1)+"…":r}}const z=1,at=2;function J(e,r){let c=["#FFF","#EEE"],f=w.scaleOrdinal(c),v=5,x,B="#AAA",O=40,_=100,s;function o(u){let S=r.domain(),D=G(i=>i),T=w.scaleOrdinal(c),Y=w.scaleOrdinal(c.reverse()),p=ot(O),M=u.selectAll(".row").data(S,r).order(),a=M.enter().append("g").attr("class","row"),m=M.exit(),l=M.select("text");M=M.merge(a).attr("transform",i=>"translate(0,"+r(i)+")"),m.remove(),a.append("rect").attr("y",.5).attr("width",_).attr("height",r.bandwidth()).attr("stroke",B).attr("stroke-width",.75).attr("fill",T),a.append("path").attr("stroke",Y),l=l.merge(a.append("text").attr("y",r.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(i,n){w.select(this).text()!=n&&D.show(n)}).on("mouseout",D.hide)).text(p),s===void 0&&(s=st(l)+2*v,s=e===z?_-s:s),x=e===z?[0,s]:[s,_],l.attr("text-anchor",e===z?"start":"end").attr("dx",e===z?v:-v).attr("x",s);const y=function(i,n){s=Math.max(10,Math.min(_-10,s+i.dx)),w.select(this).attr("d","M"+s+",0.5V"+r.range()[1]),l.attr("x",s),x=e===z?[0,s]:[s,_],u.dispatch("offset",{detail:{offset:s}})};u.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",B).attr("stroke-width",1.75).attr("d","M"+(s+.5)+",0.5V"+r.range()[1]).style("cursor","ew-resize").call(w.drag().on("drag",y))}return o.draw_ticks=function(u,S){u.selectAll(".row").select("path").attr("d",S.map(D=>"M"+D+",1v"+(r.bandwidth()-1)).join(""))},o.scale=function(u){return arguments.length?(r=u,o):r},o.width=function(u){return arguments.length?(_=u,o):_},o.colors=function(u){return arguments.length?(c=u,o):c},o.padding=function(u){return arguments.length?(v=u,o):v},o.range=function(u){return arguments.length?(x=u,o):x},o.trim=function(u){return arguments.length?(O=u,o):O},o.offset=function(u){return arguments.length?(s=u,o):s},o.colorscale=function(u){return arguments.length?(f=u,o):f},o}function X(e){return J(at,e)}function Z(e){return J(z,e)}var K=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var U={exports:{}};(function(e,r){(function(c,f){e.exports=f()})(K,function(){var c,f,v=1e3,x=6e4,B=36e5,O=864e5,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,s=31536e6,o=2628e6,u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,S={years:s,months:o,days:O,hours:B,minutes:x,seconds:v,milliseconds:1,weeks:6048e5},D=function(i){return i instanceof l},T=function(i,n,t){return new l(i,t,n.$l)},Y=function(i){return f.p(i)+"s"},p=function(i){return i<0},M=function(i){return p(i)?Math.ceil(i):Math.floor(i)},a=function(i){return Math.abs(i)},m=function(i,n){return i?p(i)?{negative:!0,format:""+a(i)+n}:{negative:!1,format:""+i+n}:{negative:!1,format:""}},l=function(){function i(t,h,g){var d=this;if(this.$d={},this.$l=g,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),h)return T(t*S[Y(h)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(A){d.$d[Y(A)]=t[A]}),this.calMilliseconds(),this;if(typeof t=="string"){var $=t.match(u);if($){var k=$.slice(2).map(function(A){return A!=null?Number(A):0});return this.$d.years=k[0],this.$d.months=k[1],this.$d.weeks=k[2],this.$d.days=k[3],this.$d.hours=k[4],this.$d.minutes=k[5],this.$d.seconds=k[6],this.calMilliseconds(),this}}return this}var n=i.prototype;return n.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(h,g){return h+(t.$d[g]||0)*S[g]},0)},n.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=M(t/s),t%=s,this.$d.months=M(t/o),t%=o,this.$d.days=M(t/O),t%=O,this.$d.hours=M(t/B),t%=B,this.$d.minutes=M(t/x),t%=x,this.$d.seconds=M(t/v),t%=v,this.$d.milliseconds=t},n.toISOString=function(){var t=m(this.$d.years,"Y"),h=m(this.$d.months,"M"),g=+this.$d.days||0;this.$d.weeks&&(g+=7*this.$d.weeks);var d=m(g,"D"),$=m(this.$d.hours,"H"),k=m(this.$d.minutes,"M"),A=this.$d.seconds||0;this.$d.milliseconds&&(A+=this.$d.milliseconds/1e3,A=Math.round(1e3*A)/1e3);var P=m(A,"S"),C=t.negative||h.negative||d.negative||$.negative||k.negative||P.negative,N=$.format||k.format||P.format?"T":"",E=(C?"-":"")+"P"+t.format+h.format+d.format+N+$.format+k.format+P.format;return E==="P"||E==="-P"?"P0D":E},n.toJSON=function(){return this.toISOString()},n.format=function(t){var h=t||"YYYY-MM-DDTHH:mm:ss",g={Y:this.$d.years,YY:f.s(this.$d.years,2,"0"),YYYY:f.s(this.$d.years,4,"0"),M:this.$d.months,MM:f.s(this.$d.months,2,"0"),D:this.$d.days,DD:f.s(this.$d.days,2,"0"),H:this.$d.hours,HH:f.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:f.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:f.s(this.$d.seconds,2,"0"),SSS:f.s(this.$d.milliseconds,3,"0")};return h.replace(_,function(d,$){return $||String(g[d])})},n.as=function(t){return this.$ms/S[Y(t)]},n.get=function(t){var h=this.$ms,g=Y(t);return g==="milliseconds"?h%=1e3:h=g==="weeks"?M(h/S[g]):this.$d[g],h||0},n.add=function(t,h,g){var d;return d=h?t*S[Y(h)]:D(t)?t.$ms:T(t,this).$ms,T(this.$ms+d*(g?-1:1),this)},n.subtract=function(t,h){return this.add(t,h,!0)},n.locale=function(t){var h=this.clone();return h.$l=t,h},n.clone=function(){return T(this.$ms,this)},n.humanize=function(t){return c().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},n.valueOf=function(){return this.asMilliseconds()},n.milliseconds=function(){return this.get("milliseconds")},n.asMilliseconds=function(){return this.as("milliseconds")},n.seconds=function(){return this.get("seconds")},n.asSeconds=function(){return this.as("seconds")},n.minutes=function(){return this.get("minutes")},n.asMinutes=function(){return this.as("minutes")},n.hours=function(){return this.get("hours")},n.asHours=function(){return this.as("hours")},n.days=function(){return this.get("days")},n.asDays=function(){return this.as("days")},n.weeks=function(){return this.get("weeks")},n.asWeeks=function(){return this.as("weeks")},n.months=function(){return this.get("months")},n.asMonths=function(){return this.as("months")},n.years=function(){return this.get("years")},n.asYears=function(){return this.as("years")},i}(),y=function(i,n,t){return i.add(n.years()*t,"y").add(n.months()*t,"M").add(n.days()*t,"d").add(n.hours()*t,"h").add(n.minutes()*t,"m").add(n.seconds()*t,"s").add(n.milliseconds()*t,"ms")};return function(i,n,t){c=t,f=t().$utils(),t.duration=function(d,$){var k=t.locale();return T(d,{$l:k},$)},t.isDuration=D;var h=n.prototype.add,g=n.prototype.subtract;n.prototype.add=function(d,$){return D(d)?y(this,d,1):h.bind(this)(d,$)},n.prototype.subtract=function(d,$){return D(d)?y(this,d,-1):g.bind(this)(d,$)}}})})(U);var ut=U.exports;const ct=Q(ut);var tt={exports:{}};(function(e,r){(function(c,f){e.exports=f()})(K,function(){return function(c,f,v){c=c||{};var x=f.prototype,B={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function O(s,o,u,S){return x.fromToBase(s,o,u,S)}v.en.relativeTime=B,x.fromToBase=function(s,o,u,S,D){for(var T,Y,p,M=u.$locale().relativeTime||B,a=c.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],m=a.length,l=0;l<m;l+=1){var y=a[l];y.d&&(T=S?v(s).diff(u,y.d,!0):u.diff(s,y.d,!0));var i=(c.rounding||Math.round)(Math.abs(T));if(p=T>0,i<=y.r||!y.r){i<=1&&l>0&&(y=a[l-1]);var n=M[y.l];D&&(i=D(""+i)),Y=typeof n=="string"?n.replace("%d",i):n(i,o,y.l,p);break}}if(o)return Y;var t=p?M.future:M.past;return typeof t=="function"?t(Y):t.replace("%s",Y)},x.to=function(s,o){return O(s,o,this,!0)},x.from=function(s,o){return O(s,o,this)};var _=function(s){return s.$u?v.utc():v()};x.toNow=function(s){return this.to(_(this),s)},x.fromNow=function(s){return this.from(_(this),s)}}})})(tt);var dt=tt.exports;const lt=Q(dt);V.extend(ct),V.extend(lt);function et(e,r){return V.duration(r-e).humanize()}function R(){const e=Array.prototype.slice.call(arguments,0);return function(r){return e.reduce((c,f)=>f(c),r)}}function q(e){return function(r){return e===void 0?r:r[e]}}const ht=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function ft(e){const r=window.getComputedStyle(e,null).getPropertyValue("font-size");return parseFloat(r)}function mt(e){return e.r*.299+e.g*.587+e.b*.114}function gt(e){return mt(e)>165}function pt(e){return gt(w.color(e))?"black":"white"}function nt(e){const r=e.getFullYear(),c=String(e.getMonth()+1).padStart(2,"0"),f=String(e.getDate()).padStart(2,"0");return`${r}${c}${f}`}function L(e,r){return"translate("+e+","+r+")"}function yt(){let e=ht,r=5,c=2,f=!1,v=!1,x,B,O=0,_=q(0),s=q(1),o=q(2),u=q(3);function S(a,m){const l=a.select("text"),y=a.select("rect"),i=y.attr("width")-2*r,n=s(m);l.text(n);let t=l.node().getComputedTextLength();if(t>i){const h=i<0?0:i/t,g=Math.floor(n.length*h);l.text(g>2?n.slice(0,g-2)+"…":"")}}function D(a,m,l){const y=a.select("text").node(),i=y.getBBox(),n=l.scale().domain().indexOf(_(m)),t=l.colorscale()(n),h=a.selectAll("rect.bckg").data([m]).join("rect").attr("class","bckg").attr("fill",t).attr("x",i.x-r+c).attr("y",i.y-2).attr("width",i.width+r-c).attr("height",i.height);a.node().insertBefore(h.node(),y)}function T(a,m){a.each(function(l,y){const i=w.select(this.parentNode);u(l)-o(l)?S(i,l):D(i,l,m)})}function Y(a){return function(m,l){w.active(this).tween("text",function(){return function(y){T(w.select(this),a)}})}}function p(a){const m=a.datum(),l=new Set(w.map(m,_)),y=new G(M),i=w.scaleOrdinal(e);x=x||[w.min(m,o),w.max(m,u)],v&&(x=w.extent(x.concat(new Date))),a.each(function(n){const t=B||this.getBoundingClientRect().width,h=l.size*(ft(this)+4*r),g=w.scaleBand().domain(l).range([0,h]),d=w.scaleTime().domain(x),$=(f?Z:X)(g).width(t),k=w.select(this).selectAll("svg").data([1]).join("svg");k.attr("class","timeline").attr("width",t).attr("height",h+20);const A=k.append("g"),P=A.append("g").attr("class","y axis").call($);let C=$.range();d.range([C[0]+r,C[1]-r]).clamp(!0);const N=w.axisBottom(d),E=A.append("g").attr("class","x axis").attr("transform",L(0,h)).call(N);P.on("offset",()=>{C=$.range(),d.range([C[0]+r,C[1]-r]).clamp(!0),N.ticks(Math.min((C[1]-C[0])/70,10)),E.call(N),H.attr("transform",b=>L(d(o(b)),g(_(b)))).selectAll("rect").attr("width",b=>d(u(b))-d(o(b))||c).call(b=>T(b,$)),P.call($.draw_ticks,d.ticks().map(d))}),E.select(".domain").remove(),E.selectAll(".tick line").attr("stroke","#AAA");const wt=d.ticks().map(d);P.call($.draw_ticks,wt);let H=A.selectAll("g.task").data(n);H.exit().remove();const I=H.enter().append("g").classed("task",!0);I.append("rect").attr("y",r).attr("height",g.bandwidth()-2*r).on("mouseover",y.show).on("mouseout",y.hide).on("click",function(b,W){var xt=String(W[1]),$t=xt.replace(" ","%20"),bt=W[2],vt=nt(bt),Mt=W[3],_t=nt(Mt),kt="https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22"+$t+"%22%20%2Bdate_when%3A%5B"+vt+"%20TO%20"+_t+"%5D%7Crows=20%7Cstart=0%7Chl=true%7Chl.fl=text_merge%7Csort=date_when%20asc%7Cff=person_keyword;subject%7Cfl=id%20index%20title%20filename%20resource_group_name%20date_when%20date_to%20author%20recipient%20person_keyword%20subject%20doc_beginning";window.open(kt,"_blank")}).style("fill",R(s,i)),I.append("text").attr("text-anchor","start").attr("fill",b=>u(b)-o(b)?R(s,i,pt)(b):"black").attr("pointer-events","none").attr("dx",r).attr("y",g.bandwidth()/2).attr("dy","0.32em").text(s),H=H.merge(I),H.attr("transform",b=>L(C[0],g(_(b)))).selectAll("rect").attr("width",0),H.transition().duration(O).attr("transform",b=>L(d(o(b)),g(_(b)))).selectAll("rect").attr("width",b=>d(u(b))-d(o(b))||c).on("start",Y($)),v&&A.append("path").attr("stroke","red").attr("d","M"+d(new Date)+",0.5V"+h)})}return p.dates=function(a){return arguments.length?(x=a,p):x},p.width=function(a){return arguments.length?(B=a,p):B},p.today=function(a){return arguments.length?(v=a,p):v},p.colors=function(a){return arguments.length?(e=a,p):e},p.padding=function(a){return arguments.length?(r=a,p):r},p.milestone_width=function(a){return arguments.length?(c=a,p):c},p.reversed=function(a){return arguments.length?(f=a,p):f},p.duration=function(a){return arguments.length?(O=a,p):O},p;function M(a,m){const l=R(w.isoParse,w.timeFormat("%Y-%m-%d")),y=`<b>${s(m)}</b><hr style="margin: 2px 0 2px 0">${l(o(m))}`,i=u(m)-o(m)?` - ${l(u(m))}<br>${et(o(m),u(m))}`:"";return y+i}}j.durationFormat=et,j.timeline=yt,j.timelineAxisLeft=X,j.timelineAxisRight=Z,j.tooltip=G,Object.keys(F).forEach(e=>{e!=="default"&&!Object.prototype.hasOwnProperty.call(j,e)&&Object.defineProperty(j,e,{enumerable:!0,get:()=>F[e]})}),Object.defineProperty(j,Symbol.toStringTag,{value:"Module"})});
