(function(T,H){typeof exports=="object"&&typeof module<"u"?H(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],H):(T=typeof globalThis<"u"?globalThis:T||self,H(T.d3=T.d3||{},T.d3,T.dayjs))})(this,function(T,H,j){"use strict";function Et(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const h=Et(H),Ft="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function Q(t){h.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(Ft);const e=h.select("body").append("div").attr("class","tooltip").style("opacity",0);return e.show=function(n){e.transition().duration(100).style("opacity",.95),e.html(t.apply(null,arguments)).style("left",n.pageX+"px").style("top",n.pageY-28+"px")},e.hide=function(n){e.transition().duration(100).style("opacity",0)},e}function Nt(t){return h.max(t.nodes().map(e=>e.getComputedTextLength()))}function Dt(t){return function(e){return e.length>t?e.slice(0,t-1)+"…":e}}const V=1,Tt=2;function st(t,e){let n=["#FFF","#FFF"],r=h.scaleOrdinal(n),s=5,i,a="#AAA",l=40,c=3e3,o;function u(m){let $=e.domain(),A=Q(x=>x),S=h.scaleOrdinal(n),F=h.scaleOrdinal(n.reverse()),k=Dt(l),C=m.selectAll(".row").data($,e).order(),g=C.enter().append("g").attr("class","row"),w=C.exit(),_=C.select("text");C=C.merge(g).attr("transform",x=>"translate(0,"+e(x)+")"),w.remove(),g.append("rect").attr("y",.5).attr("width",c).attr("height",e.bandwidth()).attr("stroke",a).attr("stroke-width",.75).attr("fill",S),g.append("path").attr("stroke",F),_=_.merge(g.append("text").attr("y",e.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(x,p){h.select(this).text()!=p&&A.show(p)}).on("mouseout",A.hide)).text(k),o===void 0&&(o=Nt(_)+2*s,o=t===V?c-o:o),i=t===V?[0,o]:[o,c],_.attr("text-anchor",t===V?"start":"end").attr("dx",t===V?s:-s).attr("x",o),m.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",a).attr("stroke-width",1.75).attr("d","M"+(o+.5)+",0.5V"+e.range()[1])}return u.draw_ticks=function(m,$){m.selectAll(".row").select("path").attr("d",$.map(A=>"M"+A+",1v"+(e.bandwidth()-1)).join(""))},u.scale=function(m){return arguments.length?(e=m,u):e},u.width=function(m){return arguments.length?(c=m,u):c},u.colors=function(m){return arguments.length?(n=m,u):n},u.padding=function(m){return arguments.length?(s=m,u):s},u.range=function(m){return arguments.length?(i=m,u):i},u.trim=function(m){return arguments.length?(l=m,u):l},u.offset=function(m){return arguments.length?(o=m,u):o},u.colorscale=function(m){return arguments.length?(r=m,u):r},u}function it(t){return st(Tt,t)}function ot(t){return st(V,t)}var at=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ct={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(at,function(){var n,r,s=1e3,i=6e4,a=36e5,l=864e5,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,m=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,$={years:o,months:u,days:l,hours:a,minutes:i,seconds:s,milliseconds:1,weeks:6048e5},A=function(p){return p instanceof _},S=function(p,d,f){return new _(p,f,d.$l)},F=function(p){return r.p(p)+"s"},k=function(p){return p<0},C=function(p){return k(p)?Math.ceil(p):Math.floor(p)},g=function(p){return Math.abs(p)},w=function(p,d){return p?k(p)?{negative:!0,format:""+g(p)+d}:{negative:!1,format:""+p+d}:{negative:!1,format:""}},_=function(){function p(f,v,M){var y=this;if(this.$d={},this.$l=M,f===void 0&&(this.$ms=0,this.parseFromMilliseconds()),v)return S(f*$[F(v)],this);if(typeof f=="number")return this.$ms=f,this.parseFromMilliseconds(),this;if(typeof f=="object")return Object.keys(f).forEach(function(D){y.$d[F(D)]=f[D]}),this.calMilliseconds(),this;if(typeof f=="string"){var E=f.match(m);if(E){var N=E.slice(2).map(function(D){return D!=null?Number(D):0});return this.$d.years=N[0],this.$d.months=N[1],this.$d.weeks=N[2],this.$d.days=N[3],this.$d.hours=N[4],this.$d.minutes=N[5],this.$d.seconds=N[6],this.calMilliseconds(),this}}return this}var d=p.prototype;return d.calMilliseconds=function(){var f=this;this.$ms=Object.keys(this.$d).reduce(function(v,M){return v+(f.$d[M]||0)*$[M]},0)},d.parseFromMilliseconds=function(){var f=this.$ms;this.$d.years=C(f/o),f%=o,this.$d.months=C(f/u),f%=u,this.$d.days=C(f/l),f%=l,this.$d.hours=C(f/a),f%=a,this.$d.minutes=C(f/i),f%=i,this.$d.seconds=C(f/s),f%=s,this.$d.milliseconds=f},d.toISOString=function(){var f=w(this.$d.years,"Y"),v=w(this.$d.months,"M"),M=+this.$d.days||0;this.$d.weeks&&(M+=7*this.$d.weeks);var y=w(M,"D"),E=w(this.$d.hours,"H"),N=w(this.$d.minutes,"M"),D=this.$d.seconds||0;this.$d.milliseconds&&(D+=this.$d.milliseconds/1e3,D=Math.round(1e3*D)/1e3);var B=w(D,"S"),P=f.negative||v.negative||y.negative||E.negative||N.negative||B.negative,W=E.format||N.format||B.format?"T":"",R=(P?"-":"")+"P"+f.format+v.format+y.format+W+E.format+N.format+B.format;return R==="P"||R==="-P"?"P0D":R},d.toJSON=function(){return this.toISOString()},d.format=function(f){var v=f||"YYYY-MM-DDTHH:mm:ss",M={Y:this.$d.years,YY:r.s(this.$d.years,2,"0"),YYYY:r.s(this.$d.years,4,"0"),M:this.$d.months,MM:r.s(this.$d.months,2,"0"),D:this.$d.days,DD:r.s(this.$d.days,2,"0"),H:this.$d.hours,HH:r.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:r.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:r.s(this.$d.seconds,2,"0"),SSS:r.s(this.$d.milliseconds,3,"0")};return v.replace(c,function(y,E){return E||String(M[y])})},d.as=function(f){return this.$ms/$[F(f)]},d.get=function(f){var v=this.$ms,M=F(f);return M==="milliseconds"?v%=1e3:v=M==="weeks"?C(v/$[M]):this.$d[M],v||0},d.add=function(f,v,M){var y;return y=v?f*$[F(v)]:A(f)?f.$ms:S(f,this).$ms,S(this.$ms+y*(M?-1:1),this)},d.subtract=function(f,v){return this.add(f,v,!0)},d.locale=function(f){var v=this.clone();return v.$l=f,v},d.clone=function(){return S(this.$ms,this)},d.humanize=function(f){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!f)},d.valueOf=function(){return this.asMilliseconds()},d.milliseconds=function(){return this.get("milliseconds")},d.asMilliseconds=function(){return this.as("milliseconds")},d.seconds=function(){return this.get("seconds")},d.asSeconds=function(){return this.as("seconds")},d.minutes=function(){return this.get("minutes")},d.asMinutes=function(){return this.as("minutes")},d.hours=function(){return this.get("hours")},d.asHours=function(){return this.as("hours")},d.days=function(){return this.get("days")},d.asDays=function(){return this.as("days")},d.weeks=function(){return this.get("weeks")},d.asWeeks=function(){return this.as("weeks")},d.months=function(){return this.get("months")},d.asMonths=function(){return this.as("months")},d.years=function(){return this.get("years")},d.asYears=function(){return this.as("years")},p}(),x=function(p,d,f){return p.add(d.years()*f,"y").add(d.months()*f,"M").add(d.days()*f,"d").add(d.hours()*f,"h").add(d.minutes()*f,"m").add(d.seconds()*f,"s").add(d.milliseconds()*f,"ms")};return function(p,d,f){n=f,r=f().$utils(),f.duration=function(y,E){var N=f.locale();return S(y,{$l:N},E)},f.isDuration=A;var v=d.prototype.add,M=d.prototype.subtract;d.prototype.add=function(y,E){return A(y)?x(this,y,1):v.bind(this)(y,E)},d.prototype.subtract=function(y,E){return A(y)?x(this,y,-1):M.bind(this)(y,E)}}})})(ct);var Bt=ct.exports;const Ot=lt(Bt);var ut={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(at,function(){return function(n,r,s){n=n||{};var i=r.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(o,u,m,$){return i.fromToBase(o,u,m,$)}s.en.relativeTime=a,i.fromToBase=function(o,u,m,$,A){for(var S,F,k,C=m.$locale().relativeTime||a,g=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],w=g.length,_=0;_<w;_+=1){var x=g[_];x.d&&(S=$?s(o).diff(m,x.d,!0):m.diff(o,x.d,!0));var p=(n.rounding||Math.round)(Math.abs(S));if(k=S>0,p<=x.r||!x.r){p<=1&&_>0&&(x=g[_-1]);var d=C[x.l];A&&(p=A(""+p)),F=typeof d=="string"?d.replace("%d",p):d(p,u,x.l,k);break}}if(u)return F;var f=k?C.future:C.past;return typeof f=="function"?f(F):f.replace("%s",F)},i.to=function(o,u){return l(o,u,this,!0)},i.from=function(o,u){return l(o,u,this)};var c=function(o){return o.$u?s.utc():s()};i.toNow=function(o){return this.to(c(this),o)},i.fromNow=function(o){return this.from(c(this),o)}}})})(ut);var Yt=ut.exports;const Pt=lt(Yt);j.extend(Ot),j.extend(Pt);function ft(t,e){return j.duration(e-t).humanize()}function tt(){const t=Array.prototype.slice.call(arguments,0);return function(e){return t.reduce((n,r)=>r(n),e)}}function Z(t){return function(e){return t===void 0?e:e[t]}}var et="http://www.w3.org/1999/xhtml";const ht={svg:"http://www.w3.org/2000/svg",xhtml:et,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ht.hasOwnProperty(e)?{space:ht[e],local:t}:t}function Rt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===et&&e.documentElement.namespaceURI===et?e.createElement(t):e.createElementNS(n,t)}}function qt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pt(t){var e=dt(t);return(e.local?qt:Rt)(e)}function zt(){}function mt(t){return t==null?zt:function(){return this.querySelector(t)}}function Ht(t){typeof t!="function"&&(t=mt(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],a=i.length,l=r[s]=new Array(a),c,o,u=0;u<a;++u)(c=i[u])&&(o=t.call(c,c.__data__,u,i))&&("__data__"in c&&(o.__data__=c.__data__),l[u]=o);return new O(r,this._parents)}function gt(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Lt(){return[]}function Vt(t){return t==null?Lt:function(){return this.querySelectorAll(t)}}function It(t){return function(){return gt(t.apply(this,arguments))}}function Wt(t){typeof t=="function"?t=It(t):t=Vt(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var a=e[i],l=a.length,c,o=0;o<l;++o)(c=a[o])&&(r.push(t.call(c,c.__data__,o,a)),s.push(c));return new O(r,s)}function Xt(t){return function(){return this.matches(t)}}function yt(t){return function(e){return e.matches(t)}}var Ut=Array.prototype.find;function Zt(t){return function(){return Ut.call(this.children,t)}}function Gt(){return this.firstElementChild}function Kt(t){return this.select(t==null?Gt:Zt(typeof t=="function"?t:yt(t)))}var Jt=Array.prototype.filter;function jt(){return Array.from(this.children)}function Qt(t){return function(){return Jt.call(this.children,t)}}function te(t){return this.selectAll(t==null?jt:Qt(typeof t=="function"?t:yt(t)))}function ee(t){typeof t!="function"&&(t=Xt(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],a=i.length,l=r[s]=[],c,o=0;o<a;++o)(c=i[o])&&t.call(c,c.__data__,o,i)&&l.push(c);return new O(r,this._parents)}function _t(t){return new Array(t.length)}function ne(){return new O(this._enter||this._groups.map(_t),this._parents)}function G(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}G.prototype={constructor:G,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function re(t){return function(){return t}}function se(t,e,n,r,s,i){for(var a=0,l,c=e.length,o=i.length;a<o;++a)(l=e[a])?(l.__data__=i[a],r[a]=l):n[a]=new G(t,i[a]);for(;a<c;++a)(l=e[a])&&(s[a]=l)}function ie(t,e,n,r,s,i,a){var l,c,o=new Map,u=e.length,m=i.length,$=new Array(u),A;for(l=0;l<u;++l)(c=e[l])&&($[l]=A=a.call(c,c.__data__,l,e)+"",o.has(A)?s[l]=c:o.set(A,c));for(l=0;l<m;++l)A=a.call(t,i[l],l,i)+"",(c=o.get(A))?(r[l]=c,c.__data__=i[l],o.delete(A)):n[l]=new G(t,i[l]);for(l=0;l<u;++l)(c=e[l])&&o.get($[l])===c&&(s[l]=c)}function oe(t){return t.__data__}function ae(t,e){if(!arguments.length)return Array.from(this,oe);var n=e?ie:se,r=this._parents,s=this._groups;typeof t!="function"&&(t=re(t));for(var i=s.length,a=new Array(i),l=new Array(i),c=new Array(i),o=0;o<i;++o){var u=r[o],m=s[o],$=m.length,A=le(t.call(u,u&&u.__data__,o,r)),S=A.length,F=l[o]=new Array(S),k=a[o]=new Array(S),C=c[o]=new Array($);n(u,m,F,k,C,A,e);for(var g=0,w=0,_,x;g<S;++g)if(_=F[g]){for(g>=w&&(w=g+1);!(x=k[w])&&++w<S;);_._next=x||null}}return a=new O(a,r),a._enter=l,a._exit=c,a}function le(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ce(){return new O(this._exit||this._groups.map(_t),this._parents)}function ue(t,e,n){var r=this.enter(),s=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function fe(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,i=r.length,a=Math.min(s,i),l=new Array(s),c=0;c<a;++c)for(var o=n[c],u=r[c],m=o.length,$=l[c]=new Array(m),A,S=0;S<m;++S)(A=o[S]||u[S])&&($[S]=A);for(;c<s;++c)l[c]=n[c];return new O(l,this._parents)}function he(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function de(t){t||(t=pe);function e(m,$){return m&&$?t(m.__data__,$.__data__):!m-!$}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],l=a.length,c=s[i]=new Array(l),o,u=0;u<l;++u)(o=a[u])&&(c[u]=o);c.sort(e)}return new O(s,this._parents).order()}function pe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function me(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function ge(){return Array.from(this)}function ye(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function _e(){let t=0;for(const e of this)++t;return t}function we(){return!this.node()}function xe(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],i=0,a=s.length,l;i<a;++i)(l=s[i])&&t.call(l,l.__data__,i,s);return this}function ve(t){return function(){this.removeAttribute(t)}}function Ae(t){return function(){this.removeAttributeNS(t.space,t.local)}}function be(t,e){return function(){this.setAttribute(t,e)}}function $e(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Se(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ke(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Me(t,e){var n=dt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ae:ve:typeof e=="function"?n.local?ke:Se:n.local?$e:be)(n,e))}function wt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ce(t){return function(){this.style.removeProperty(t)}}function Ee(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Fe(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Ne(t,e,n){return arguments.length>1?this.each((e==null?Ce:typeof e=="function"?Fe:Ee)(t,e,n??"")):De(this.node(),t)}function De(t,e){return t.style.getPropertyValue(e)||wt(t).getComputedStyle(t,null).getPropertyValue(e)}function Te(t){return function(){delete this[t]}}function Be(t,e){return function(){this[t]=e}}function Oe(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ye(t,e){return arguments.length>1?this.each((e==null?Te:typeof e=="function"?Oe:Be)(t,e)):this.node()[t]}function xt(t){return t.trim().split(/^|\s+/)}function nt(t){return t.classList||new vt(t)}function vt(t){this._node=t,this._names=xt(t.getAttribute("class")||"")}vt.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function At(t,e){for(var n=nt(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function bt(t,e){for(var n=nt(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function Pe(t){return function(){At(this,t)}}function Re(t){return function(){bt(this,t)}}function qe(t,e){return function(){(e.apply(this,arguments)?At:bt)(this,t)}}function ze(t,e){var n=xt(t+"");if(arguments.length<2){for(var r=nt(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?qe:e?Pe:Re)(n,e))}function He(){this.textContent=""}function Le(t){return function(){this.textContent=t}}function Ve(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Ie(t){return arguments.length?this.each(t==null?He:(typeof t=="function"?Ve:Le)(t)):this.node().textContent}function We(){this.innerHTML=""}function Xe(t){return function(){this.innerHTML=t}}function Ue(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ze(t){return arguments.length?this.each(t==null?We:(typeof t=="function"?Ue:Xe)(t)):this.node().innerHTML}function Ge(){this.nextSibling&&this.parentNode.appendChild(this)}function Ke(){return this.each(Ge)}function Je(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function je(){return this.each(Je)}function Qe(t){var e=typeof t=="function"?t:pt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function tn(){return null}function en(t,e){var n=typeof t=="function"?t:pt(t),r=e==null?tn:typeof e=="function"?e:mt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function nn(){var t=this.parentNode;t&&t.removeChild(this)}function rn(){return this.each(nn)}function sn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function on(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function an(t){return this.select(t?on:sn)}function ln(t){return arguments.length?this.property("__data__",t):this.node().__data__}function cn(t){return function(e){t.call(this,e,this.__data__)}}function un(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function fn(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,i;n<s;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function hn(t,e,n){return function(){var r=this.__on,s,i=cn(e);if(r){for(var a=0,l=r.length;a<l;++a)if((s=r[a]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=e;return}}this.addEventListener(t.type,i,n),s={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(s):this.__on=[s]}}function dn(t,e,n){var r=un(t+""),s,i=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,o=l.length,u;c<o;++c)for(s=0,u=l[c];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(l=e?hn:fn,s=0;s<i;++s)this.each(l(r[s],e,n));return this}function $t(t,e,n){var r=wt(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function pn(t,e){return function(){return $t(this,t,e)}}function mn(t,e){return function(){return $t(this,t,e.apply(this,arguments))}}function gn(t,e){return this.each((typeof e=="function"?mn:pn)(t,e))}function*yn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var _n=[null];function O(t,e){this._groups=t,this._parents=e}function wn(){return this}O.prototype={constructor:O,select:Ht,selectAll:Wt,selectChild:Kt,selectChildren:te,filter:ee,data:ae,enter:ne,exit:ce,join:ue,merge:fe,selection:wn,order:he,sort:de,call:me,nodes:ge,node:ye,size:_e,empty:we,each:xe,attr:Me,style:Ne,property:Ye,classed:ze,text:Ie,html:Ze,raise:Ke,lower:je,append:Qe,insert:en,remove:rn,clone:an,datum:ln,on:dn,dispatch:gn,[Symbol.iterator]:yn};function St(t){return typeof t=="string"?new O([document.querySelectorAll(t)],[document.documentElement]):new O([gt(t)],_n)}const xn=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function vn(t){const e=window.getComputedStyle(t,null).getPropertyValue("font-size");return parseFloat(e)}function An(t){return t.r*.299+t.g*.587+t.b*.114}function bn(t){return An(t)>165}function $n(t){return bn(h.color(t))?"black":"white"}function kt(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}${n}${r}`}function I(t,e){return"translate("+t+","+e+")"}function Sn(){document.querySelectorAll('g.task[class*=" --"]').forEach(function(e){e.style.display="none"})}function K(t,e,n){const s=h.select(t).attr("class");let i=!1;e.selectAll("g.row").each(function(g){const _=h.select(this).attr("class");if(_==s)i=!0;else if(i){let p=this.getAttribute("transform"),d=parseFloat(p.split("(")[1].split(",")[0].trim()),f=parseFloat(p.split(",")[1].split(")")[0].trim());this.setAttribute("transform",`translate(${d},${f+n})`);var x=_.split(" ")[1];document.querySelectorAll(`g.task.${x} rect`).forEach(function(y){y.setAttribute("y",parseFloat(y.getAttribute("y"))+n)}),document.querySelectorAll(`g.task.${x} text`).forEach(function(y){y.setAttribute("y",parseFloat(y.getAttribute("y"))+n)})}});const a=document.querySelector('path[stroke-width="1.75"]');let c=a.getAttribute("d").match(/M([\d.-]+),([\d.-]+)V([\d.-]+)/),o=parseFloat(c[1]),u=parseFloat(c[2]),$=parseFloat(c[3])+n;a.setAttribute("d",`M${o},${u}V${$}`);const A=h.select("g.x.axis.bottom-axis");let S=A.attr("transform"),F=parseFloat(S.split("(")[1].split(",")[0].trim()),C=parseFloat(S.split(",")[1].split(")")[0].trim())+n;A.attr("transform",`translate(${F}, ${C})`)}function Mt(t,e){e.forEach(function(r){document.querySelectorAll(`g.row.${r}`).forEach(function(i){i.style.display="block"})});const n=h.select(t).attr("class").split(" ")[1];h.selectAll(`g.task.${n}`).each(function(r){var s=r[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(s==n.replace(/--/g,""))h.select(this).style("display","none");else if(s!=n.replace(/--/g,"")){h.select(this).style("display","block");var i=(e.indexOf(s)+1)*38;let a=h.select(this),l=a.attr("transform"),c=parseFloat(l.split("(")[1].split(",")[0].trim()),o=parseFloat(l.split(",")[1].split(")")[0].trim()),u=o+i;a.attr("transform",`translate(${c}, ${o})`).transition().duration(1e3).attr("transform",`translate(${c}, ${u})`).on("start",()=>{St(`g.task.${s}`).style("display","none")}).on("end",()=>{a.style("display","none"),a.attr("transform",`translate(${c}, ${o})`),St(`g.task.${s}`).style("display","block")})}})}function Ct(t,e){return new Promise(n=>{const r=h.select(t).attr("class").split(" ")[1];h.selectAll(`g.task:not(.${r})`).each(function(s){var i=s[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(e.includes(i)){h.select(this).style("display","block");var a=(e.indexOf(i)+1)*38;let l=h.select(this),c=l.attr("transform"),o=parseFloat(c.split("(")[1].split(",")[0].trim()),u=parseFloat(c.split(",")[1].split(")")[0].trim()),m=u-a;l.transition().duration(1e3).attr("transform",`translate(${o}, ${m})`).on("end",()=>{h.selectAll(`g.${r}`).style("display","block"),l.style("display","none"),l.attr("transform",`translate(${o}, ${u})`),e.forEach(function($){document.querySelectorAll(`.${$}`).forEach(function(S){S.style.display="none"})}),n()})}})})}function J(t,e){const r=h.select(t).attr("class"),s=[];let i=!1,a=!1;return e.selectAll("g.row").each(function(l){const o=h.select(this).attr("class");o==r?i=!0:i&&o.split(" ")[2]=="timelineheader"?a=!0:i&&!a&&s.push(o.split(" ")[1])}),s}function kn(){const t=document.getElementById("collapseAllButton");t.disabled=!0;let e=[];h.selectAll("g.row.timelineheader text").each(function(){if(h.select(this).text()==="-"){const r=this.parentNode,s=J(r,h.select(r.parentNode)),i=s.length*38;let a=Ct(r,s).then(()=>{K(r,h.select(r.parentNode),-i),h.select(this).text("+").style("font-size","20px")});e.push(a)}}),Promise.all(e).then(()=>{t.disabled=!1})}window.collapseAll=kn;function Mn(){const t=document.getElementById("expandAllButton");t.disabled=!0;let e=[];h.selectAll("g.row.timelineheader text").each(function(){if(h.select(this).text()==="+"){const r=this.parentNode,s=J(r,h.select(r.parentNode)),i=s.length*38;let a=new Promise(l=>{Mt(r,s),K(r,h.select(r.parentNode),i),l()}).then(()=>{h.select(this).text("-").style("font-size","30px")});e.push(a)}}),Promise.all(e).then(()=>{t.disabled=!1})}window.expandAll=Mn;function Cn(){let t=xn,e=5,n=2,r=!1,s=!1,i,a,l=0,c=Z(0),o=Z(1),u=Z(2),m=Z(3);function $(g,w){const _=g.select("text"),x=g.select("rect"),p=x.attr("width")-2*e,d=o(w);_.text(d);let f=_.node().getComputedTextLength();if(f>p){const v=p<0?0:p/f,M=Math.floor(d.length*v);_.text(M>2?d.slice(0,M-2)+"…":"")}}function A(g,w,_){const x=g.select("text").node(),p=x.getBBox(),d=_.scale().domain().indexOf(c(w)),f=_.colorscale()(d),v=g.selectAll("rect.bckg").data([w]).join("rect").attr("class","bckg").attr("fill",f).attr("x",p.x-e+n).attr("y",p.y-2).attr("width",p.width+e-n).attr("height",p.height);g.node().insertBefore(v.node(),x)}function S(g,w){g.each(function(_,x){const p=h.select(this.parentNode);m(_)-u(_)?$(p,_):A(p,_,w)})}function F(g){return function(w,_){h.active(this).tween("text",function(){return function(x){S(h.select(this),g)}})}}function k(g){const w=g.datum(),_=new Set(h.map(w,c)),x=new Q(C),p=h.scaleOrdinal(t);i=i||[h.min(w,u),h.max(w,m)],s&&(i=h.extent(i.concat(new Date))),g.each(function(d){const f=a||this.getBoundingClientRect().width,v=_.size*(vn(this)+4*e),M=h.scaleBand().domain(_).range([0,v]),y=h.scaleTime().domain(i),E=(r?ot:it)(M).width(f),N=h.select(this).selectAll("svg").data([1]).join("svg");N.attr("class","timeline").attr("width",f).attr("height",v+40);const D=N.append("g").attr("transform","translate(0,20)"),B=D.append("g").attr("class","y axis").call(E);B.selectAll("text").on("mouseover",function(){h.select(this).style("text-decoration","underline")}).on("mouseout",function(){h.select(this).style("text-decoration","none")}).attr("text-anchor",function(b){return b.startsWith(" •")?"middle":"end"}).attr("x",function(b){return b.startsWith(" •")?167:332.5}).style("cursor","pointer").style("font-weight",function(b){return b.startsWith(" •")?"bold":"normal"}).style("background","none").on("click",function(b,Y){const z=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${Y.replace(/ • /g,"").replace(" ","%20")}%22`;window.open(z,"_blank")}),B.selectAll("g.row").each(function(b){const Y=h.select(this).datum();h.select(this).classed(h.select(this).datum().replace(/•/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,""),!0),Y.startsWith(" •")&&h.select(this).classed("timelineheader",!0).append("text").attr("x",320.5).attr("y",25).text("-").style("text-anchor","end").style("cursor","pointer").style("font-size","30px").attr("fill","black").style("-ms-user-select","none").style("-webkit-user-select","none").style("user-select","none")}),B.selectAll("g.row.timelineheader text").on("click",function(b,Y){const X=h.select(this).text();if(X==="+"){let q=J(this.parentNode,B),z=q.length*38;Mt(this.parentNode,q),K(this.parentNode,B,z),h.select(this).text()==="+"?h.select(this).text("-").style("font-size","30px"):h.select(this).text("+")}else if(X==="-"){let q=J(this.parentNode,B),z=q.length*38;Ct(this.parentNode,q).then(()=>{K(this.parentNode,B,-z)}),h.select(this).text()==="-"?h.select(this).text("+").style("font-size","20px"):h.select(this).text("-")}else{const U=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${Y.replace(/ • /g,"").replace(" ","%20")}%22`;window.open(U,"_blank")}});let P=E.range();y.range([P[0]+e,P[1]-e]).clamp(!0);const W=h.axisBottom(y),R=D.append("g").attr("class","x axis").attr("transform",I(0,0)).call(W);R.selectAll(".tick text").attr("dy","-1.5em"),R.selectAll(".tick line").attr("y2","-5");const En=h.axisBottom(y);N.append("g").attr("class","x axis bottom-axis").attr("transform",I(0,v+20)).call(En).selectAll(".tick line").attr("y2","5"),B.on("offset",()=>{P=E.range(),y.range([P[0]+e,P[1]-e]).clamp(!0),W.ticks(Math.min((P[1]-P[0])/70,10)),R.call(W),L.attr("transform",b=>I(y(u(b)),M(c(b)))).selectAll("rect").attr("width",b=>y(m(b))-y(u(b))||n).call(b=>S(b,E)),B.call(E.draw_ticks,y.ticks().map(y))}),R.select(".domain").remove(),R.selectAll(".tick line").attr("stroke","#AAA");const Fn=y.ticks().map(y);B.call(E.draw_ticks,Fn);let L=D.selectAll("g.task").data(d);L.exit().remove();const rt=L.enter().append("g").classed("task",!0);rt.each(function(b){const Y=c(b).replace(/•/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");h.select(this).classed(Y,!0)}).append("rect").style("opacity",1).attr("y",e).style("cursor","pointer").attr("height",M.bandwidth()-2*e).on("mouseover",x.show).on("mouseout",x.hide).on("click",function(b,Y){var X=String(Y[1]),q=X.replace(" ","%20"),z=Y[2],U=kt(z),Nn=Y[3],Dn=kt(Nn),Tn="https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22"+q+"%22%20%2Bdate_when%3A%5B"+U+"%20TO%20"+Dn+"%5D%7Crows=20%7Cstart=0%7Chl=true%7Chl.fl=text_merge%7Csort=date_when%20asc%7Cff=person_keyword;subject%7Cfl=id%20index%20title%20filename%20resource_group_name%20date_when%20date_to%20author%20recipient%20person_keyword%20subject%20doc_beginning";window.open(Tn,"_blank")}).style("fill",tt(o,p)),rt.append("text").attr("text-anchor","start").attr("fill",b=>m(b)-u(b)?tt(o,p,$n)(b):"black").attr("pointer-events","none").attr("dx",e).attr("y",M.bandwidth()/2).attr("dy","0.32em").text(o),L=L.merge(rt),L.attr("transform",b=>I(P[0],M(c(b)))).selectAll("rect").attr("width",0),L.transition().duration(l).attr("transform",b=>I(y(u(b)),M(c(b)))).selectAll("rect").attr("width",b=>y(m(b))-y(u(b))||n).on("start",F(E)),s&&D.append("path").attr("stroke","red").attr("d","M"+y(new Date)+",0.5V"+v)}),Sn()}return k.dates=function(g){return arguments.length?(i=g,k):i},k.width=function(g){return arguments.length?(a=g,k):a},k.today=function(g){return arguments.length?(s=g,k):s},k.colors=function(g){return arguments.length?(t=g,k):t},k.padding=function(g){return arguments.length?(e=g,k):e},k.milestone_width=function(g){return arguments.length?(n=g,k):n},k.reversed=function(g){return arguments.length?(r=g,k):r},k.duration=function(g){return arguments.length?(l=g,k):l},k;function C(g,w){const _=tt(h.isoParse,h.timeFormat("%Y-%m-%d")),x=`<b>${o(w)}</b><hr style="margin: 2px 0 2px 0">${_(u(w))}`,p=m(w)-u(w)?` - ${_(m(w))}<br>${ft(u(w),m(w))}`:"";return x+p}}T.durationFormat=ft,T.timeline=Cn,T.timelineAxisLeft=it,T.timelineAxisRight=ot,T.tooltip=Q,Object.keys(H).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(T,t)&&Object.defineProperty(T,t,{enumerable:!0,get:()=>H[t]})}),Object.defineProperty(T,Symbol.toStringTag,{value:"Module"})});
