(function(N,L){typeof exports=="object"&&typeof module<"u"?L(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],L):(N=typeof globalThis<"u"?globalThis:N||self,L(N.d3=N.d3||{},N.d3,N.dayjs))})(this,function(N,L,K){"use strict";function Mt(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const m=Mt(L),Ct="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function J(t){m.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(Ct);const e=m.select("body").append("div").attr("class","tooltip").style("opacity",0);return e.show=function(n){e.transition().duration(100).style("opacity",.95),e.html(t.apply(null,arguments)).style("left",n.pageX+"px").style("top",n.pageY-28+"px")},e.hide=function(n){e.transition().duration(100).style("opacity",0)},e}function Ft(t){return m.max(t.nodes().map(e=>e.getComputedTextLength()))}function Et(t){return function(e){return e.length>t?e.slice(0,t-1)+"â€¦":e}}const V=1,Dt=2;function nt(t,e){let n=["#FFF","#FFF"],i=m.scaleOrdinal(n),r=5,s,a="#AAA",l=40,c=3e3,o;function u(p){let S=e.domain(),b=J(v=>v),M=m.scaleOrdinal(n),E=m.scaleOrdinal(n.reverse()),A=Et(l),C=p.selectAll(".row").data(S,e).order(),g=C.enter().append("g").attr("class","row"),w=C.exit(),_=C.select("text");C=C.merge(g).attr("transform",v=>"translate(0,"+e(v)+")"),w.remove(),g.append("rect").attr("y",.5).attr("width",c).attr("height",e.bandwidth()).attr("stroke",a).attr("stroke-width",.75).attr("fill",M),g.append("path").attr("stroke",E),_=_.merge(g.append("text").attr("y",e.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(v,d){m.select(this).text()!=d&&b.show(d)}).on("mouseout",b.hide)).text(A),o===void 0&&(o=Ft(_)+2*r,o=t===V?c-o:o),s=t===V?[0,o]:[o,c],_.attr("text-anchor",t===V?"start":"end").attr("dx",t===V?r:-r).attr("x",o),p.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",a).attr("stroke-width",1.75).attr("d","M"+(o+.5)+",0.5V"+e.range()[1])}return u.draw_ticks=function(p,S){p.selectAll(".row").select("path").attr("d",S.map(b=>"M"+b+",1v"+(e.bandwidth()-1)).join(""))},u.scale=function(p){return arguments.length?(e=p,u):e},u.width=function(p){return arguments.length?(c=p,u):c},u.colors=function(p){return arguments.length?(n=p,u):n},u.padding=function(p){return arguments.length?(r=p,u):r},u.range=function(p){return arguments.length?(s=p,u):s},u.trim=function(p){return arguments.length?(l=p,u):l},u.offset=function(p){return arguments.length?(o=p,u):o},u.colorscale=function(p){return arguments.length?(i=p,u):i},u}function rt(t){return nt(Dt,t)}function it(t){return nt(V,t)}var st=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ot(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var at={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(st,function(){var n,i,r=1e3,s=6e4,a=36e5,l=864e5,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,o=31536e6,u=2628e6,p=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,S={years:o,months:u,days:l,hours:a,minutes:s,seconds:r,milliseconds:1,weeks:6048e5},b=function(d){return d instanceof _},M=function(d,h,f){return new _(d,f,h.$l)},E=function(d){return i.p(d)+"s"},A=function(d){return d<0},C=function(d){return A(d)?Math.ceil(d):Math.floor(d)},g=function(d){return Math.abs(d)},w=function(d,h){return d?A(d)?{negative:!0,format:""+g(d)+h}:{negative:!1,format:""+d+h}:{negative:!1,format:""}},_=function(){function d(f,x,k){var y=this;if(this.$d={},this.$l=k,f===void 0&&(this.$ms=0,this.parseFromMilliseconds()),x)return M(f*S[E(x)],this);if(typeof f=="number")return this.$ms=f,this.parseFromMilliseconds(),this;if(typeof f=="object")return Object.keys(f).forEach(function(T){y.$d[E(T)]=f[T]}),this.calMilliseconds(),this;if(typeof f=="string"){var F=f.match(p);if(F){var D=F.slice(2).map(function(T){return T!=null?Number(T):0});return this.$d.years=D[0],this.$d.months=D[1],this.$d.weeks=D[2],this.$d.days=D[3],this.$d.hours=D[4],this.$d.minutes=D[5],this.$d.seconds=D[6],this.calMilliseconds(),this}}return this}var h=d.prototype;return h.calMilliseconds=function(){var f=this;this.$ms=Object.keys(this.$d).reduce(function(x,k){return x+(f.$d[k]||0)*S[k]},0)},h.parseFromMilliseconds=function(){var f=this.$ms;this.$d.years=C(f/o),f%=o,this.$d.months=C(f/u),f%=u,this.$d.days=C(f/l),f%=l,this.$d.hours=C(f/a),f%=a,this.$d.minutes=C(f/s),f%=s,this.$d.seconds=C(f/r),f%=r,this.$d.milliseconds=f},h.toISOString=function(){var f=w(this.$d.years,"Y"),x=w(this.$d.months,"M"),k=+this.$d.days||0;this.$d.weeks&&(k+=7*this.$d.weeks);var y=w(k,"D"),F=w(this.$d.hours,"H"),D=w(this.$d.minutes,"M"),T=this.$d.seconds||0;this.$d.milliseconds&&(T+=this.$d.milliseconds/1e3,T=Math.round(1e3*T)/1e3);var O=w(T,"S"),R=f.negative||x.negative||y.negative||F.negative||D.negative||O.negative,W=F.format||D.format||O.format?"T":"",q=(R?"-":"")+"P"+f.format+x.format+y.format+W+F.format+D.format+O.format;return q==="P"||q==="-P"?"P0D":q},h.toJSON=function(){return this.toISOString()},h.format=function(f){var x=f||"YYYY-MM-DDTHH:mm:ss",k={Y:this.$d.years,YY:i.s(this.$d.years,2,"0"),YYYY:i.s(this.$d.years,4,"0"),M:this.$d.months,MM:i.s(this.$d.months,2,"0"),D:this.$d.days,DD:i.s(this.$d.days,2,"0"),H:this.$d.hours,HH:i.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:i.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:i.s(this.$d.seconds,2,"0"),SSS:i.s(this.$d.milliseconds,3,"0")};return x.replace(c,function(y,F){return F||String(k[y])})},h.as=function(f){return this.$ms/S[E(f)]},h.get=function(f){var x=this.$ms,k=E(f);return k==="milliseconds"?x%=1e3:x=k==="weeks"?C(x/S[k]):this.$d[k],x||0},h.add=function(f,x,k){var y;return y=x?f*S[E(x)]:b(f)?f.$ms:M(f,this).$ms,M(this.$ms+y*(k?-1:1),this)},h.subtract=function(f,x){return this.add(f,x,!0)},h.locale=function(f){var x=this.clone();return x.$l=f,x},h.clone=function(){return M(this.$ms,this)},h.humanize=function(f){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!f)},h.valueOf=function(){return this.asMilliseconds()},h.milliseconds=function(){return this.get("milliseconds")},h.asMilliseconds=function(){return this.as("milliseconds")},h.seconds=function(){return this.get("seconds")},h.asSeconds=function(){return this.as("seconds")},h.minutes=function(){return this.get("minutes")},h.asMinutes=function(){return this.as("minutes")},h.hours=function(){return this.get("hours")},h.asHours=function(){return this.as("hours")},h.days=function(){return this.get("days")},h.asDays=function(){return this.as("days")},h.weeks=function(){return this.get("weeks")},h.asWeeks=function(){return this.as("weeks")},h.months=function(){return this.get("months")},h.asMonths=function(){return this.as("months")},h.years=function(){return this.get("years")},h.asYears=function(){return this.as("years")},d}(),v=function(d,h,f){return d.add(h.years()*f,"y").add(h.months()*f,"M").add(h.days()*f,"d").add(h.hours()*f,"h").add(h.minutes()*f,"m").add(h.seconds()*f,"s").add(h.milliseconds()*f,"ms")};return function(d,h,f){n=f,i=f().$utils(),f.duration=function(y,F){var D=f.locale();return M(y,{$l:D},F)},f.isDuration=b;var x=h.prototype.add,k=h.prototype.subtract;h.prototype.add=function(y,F){return b(y)?v(this,y,1):x.bind(this)(y,F)},h.prototype.subtract=function(y,F){return b(y)?v(this,y,-1):k.bind(this)(y,F)}}})})(at);var Tt=at.exports;const Nt=ot(Tt);var lt={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(st,function(){return function(n,i,r){n=n||{};var s=i.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function l(o,u,p,S){return s.fromToBase(o,u,p,S)}r.en.relativeTime=a,s.fromToBase=function(o,u,p,S,b){for(var M,E,A,C=p.$locale().relativeTime||a,g=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],w=g.length,_=0;_<w;_+=1){var v=g[_];v.d&&(M=S?r(o).diff(p,v.d,!0):p.diff(o,v.d,!0));var d=(n.rounding||Math.round)(Math.abs(M));if(A=M>0,d<=v.r||!v.r){d<=1&&_>0&&(v=g[_-1]);var h=C[v.l];b&&(d=b(""+d)),E=typeof h=="string"?h.replace("%d",d):h(d,u,v.l,A);break}}if(u)return E;var f=A?C.future:C.past;return typeof f=="function"?f(E):f.replace("%s",E)},s.to=function(o,u){return l(o,u,this,!0)},s.from=function(o,u){return l(o,u,this)};var c=function(o){return o.$u?r.utc():r()};s.toNow=function(o){return this.to(c(this),o)},s.fromNow=function(o){return this.from(c(this),o)}}})})(lt);var Ot=lt.exports;const Yt=ot(Ot);K.extend(Nt),K.extend(Yt);function ct(t,e){return K.duration(e-t).humanize()}function Q(){const t=Array.prototype.slice.call(arguments,0);return function(e){return t.reduce((n,i)=>i(n),e)}}function Z(t){return function(e){return t===void 0?e:e[t]}}var j="http://www.w3.org/1999/xhtml";const ut={svg:"http://www.w3.org/2000/svg",xhtml:j,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ft(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ut.hasOwnProperty(e)?{space:ut[e],local:t}:t}function Bt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===j&&e.documentElement.namespaceURI===j?e.createElement(t):e.createElementNS(n,t)}}function Rt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ht(t){var e=ft(t);return(e.local?Rt:Bt)(e)}function qt(){}function dt(t){return t==null?qt:function(){return this.querySelector(t)}}function Pt(t){typeof t!="function"&&(t=dt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,l=i[r]=new Array(a),c,o,u=0;u<a;++u)(c=s[u])&&(o=t.call(c,c.__data__,u,s))&&("__data__"in c&&(o.__data__=c.__data__),l[u]=o);return new Y(i,this._parents)}function pt(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Ht(){return[]}function Lt(t){return t==null?Ht:function(){return this.querySelectorAll(t)}}function zt(t){return function(){return pt(t.apply(this,arguments))}}function Vt(t){typeof t=="function"?t=zt(t):t=Lt(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var a=e[s],l=a.length,c,o=0;o<l;++o)(c=a[o])&&(i.push(t.call(c,c.__data__,o,a)),r.push(c));return new Y(i,r)}function It(t){return function(){return this.matches(t)}}function mt(t){return function(e){return e.matches(t)}}var Wt=Array.prototype.find;function Xt(t){return function(){return Wt.call(this.children,t)}}function Ut(){return this.firstElementChild}function Zt(t){return this.select(t==null?Ut:Xt(typeof t=="function"?t:mt(t)))}var Gt=Array.prototype.filter;function Kt(){return Array.from(this.children)}function Jt(t){return function(){return Gt.call(this.children,t)}}function Qt(t){return this.selectAll(t==null?Kt:Jt(typeof t=="function"?t:mt(t)))}function jt(t){typeof t!="function"&&(t=It(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],a=s.length,l=i[r]=[],c,o=0;o<a;++o)(c=s[o])&&t.call(c,c.__data__,o,s)&&l.push(c);return new Y(i,this._parents)}function gt(t){return new Array(t.length)}function te(){return new Y(this._enter||this._groups.map(gt),this._parents)}function G(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}G.prototype={constructor:G,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ee(t){return function(){return t}}function ne(t,e,n,i,r,s){for(var a=0,l,c=e.length,o=s.length;a<o;++a)(l=e[a])?(l.__data__=s[a],i[a]=l):n[a]=new G(t,s[a]);for(;a<c;++a)(l=e[a])&&(r[a]=l)}function re(t,e,n,i,r,s,a){var l,c,o=new Map,u=e.length,p=s.length,S=new Array(u),b;for(l=0;l<u;++l)(c=e[l])&&(S[l]=b=a.call(c,c.__data__,l,e)+"",o.has(b)?r[l]=c:o.set(b,c));for(l=0;l<p;++l)b=a.call(t,s[l],l,s)+"",(c=o.get(b))?(i[l]=c,c.__data__=s[l],o.delete(b)):n[l]=new G(t,s[l]);for(l=0;l<u;++l)(c=e[l])&&o.get(S[l])===c&&(r[l]=c)}function ie(t){return t.__data__}function se(t,e){if(!arguments.length)return Array.from(this,ie);var n=e?re:ne,i=this._parents,r=this._groups;typeof t!="function"&&(t=ee(t));for(var s=r.length,a=new Array(s),l=new Array(s),c=new Array(s),o=0;o<s;++o){var u=i[o],p=r[o],S=p.length,b=oe(t.call(u,u&&u.__data__,o,i)),M=b.length,E=l[o]=new Array(M),A=a[o]=new Array(M),C=c[o]=new Array(S);n(u,p,E,A,C,b,e);for(var g=0,w=0,_,v;g<M;++g)if(_=E[g]){for(g>=w&&(w=g+1);!(v=A[w])&&++w<M;);_._next=v||null}}return a=new Y(a,i),a._enter=l,a._exit=c,a}function oe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ae(){return new Y(this._exit||this._groups.map(gt),this._parents)}function le(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function ce(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,a=Math.min(r,s),l=new Array(r),c=0;c<a;++c)for(var o=n[c],u=i[c],p=o.length,S=l[c]=new Array(p),b,M=0;M<p;++M)(b=o[M]||u[M])&&(S[M]=b);for(;c<r;++c)l[c]=n[c];return new Y(l,this._parents)}function ue(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],a;--r>=0;)(a=i[r])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function fe(t){t||(t=he);function e(p,S){return p&&S?t(p.__data__,S.__data__):!p-!S}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var a=n[s],l=a.length,c=r[s]=new Array(l),o,u=0;u<l;++u)(o=a[u])&&(c[u]=o);c.sort(e)}return new Y(r,this._parents).order()}function he(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function de(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function pe(){return Array.from(this)}function me(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var a=i[r];if(a)return a}return null}function ge(){let t=0;for(const e of this)++t;return t}function ye(){return!this.node()}function _e(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,a=r.length,l;s<a;++s)(l=r[s])&&t.call(l,l.__data__,s,r);return this}function we(t){return function(){this.removeAttribute(t)}}function ve(t){return function(){this.removeAttributeNS(t.space,t.local)}}function xe(t,e){return function(){this.setAttribute(t,e)}}function be(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ae(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function $e(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Se(t,e){var n=ft(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ve:we:typeof e=="function"?n.local?$e:Ae:n.local?be:xe)(n,e))}function yt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ke(t){return function(){this.style.removeProperty(t)}}function Me(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ce(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Fe(t,e,n){return arguments.length>1?this.each((e==null?ke:typeof e=="function"?Ce:Me)(t,e,n??"")):Ee(this.node(),t)}function Ee(t,e){return t.style.getPropertyValue(e)||yt(t).getComputedStyle(t,null).getPropertyValue(e)}function De(t){return function(){delete this[t]}}function Te(t,e){return function(){this[t]=e}}function Ne(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Oe(t,e){return arguments.length>1?this.each((e==null?De:typeof e=="function"?Ne:Te)(t,e)):this.node()[t]}function _t(t){return t.trim().split(/^|\s+/)}function tt(t){return t.classList||new wt(t)}function wt(t){this._node=t,this._names=_t(t.getAttribute("class")||"")}wt.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function vt(t,e){for(var n=tt(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function xt(t,e){for(var n=tt(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Ye(t){return function(){vt(this,t)}}function Be(t){return function(){xt(this,t)}}function Re(t,e){return function(){(e.apply(this,arguments)?vt:xt)(this,t)}}function qe(t,e){var n=_t(t+"");if(arguments.length<2){for(var i=tt(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Re:e?Ye:Be)(n,e))}function Pe(){this.textContent=""}function He(t){return function(){this.textContent=t}}function Le(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function ze(t){return arguments.length?this.each(t==null?Pe:(typeof t=="function"?Le:He)(t)):this.node().textContent}function Ve(){this.innerHTML=""}function Ie(t){return function(){this.innerHTML=t}}function We(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Xe(t){return arguments.length?this.each(t==null?Ve:(typeof t=="function"?We:Ie)(t)):this.node().innerHTML}function Ue(){this.nextSibling&&this.parentNode.appendChild(this)}function Ze(){return this.each(Ue)}function Ge(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ke(){return this.each(Ge)}function Je(t){var e=typeof t=="function"?t:ht(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Qe(){return null}function je(t,e){var n=typeof t=="function"?t:ht(t),i=e==null?Qe:typeof e=="function"?e:dt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function tn(){var t=this.parentNode;t&&t.removeChild(this)}function en(){return this.each(tn)}function nn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function sn(t){return this.select(t?rn:nn)}function on(t){return arguments.length?this.property("__data__",t):this.node().__data__}function an(t){return function(e){t.call(this,e,this.__data__)}}function ln(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function cn(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function un(t,e,n){return function(){var i=this.__on,r,s=an(e);if(i){for(var a=0,l=i.length;a<l;++a)if((r=i[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function fn(t,e,n){var i=ln(t+""),r,s=i.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,o=l.length,u;c<o;++c)for(r=0,u=l[c];r<s;++r)if((a=i[r]).type===u.type&&a.name===u.name)return u.value}return}for(l=e?un:cn,r=0;r<s;++r)this.each(l(i[r],e,n));return this}function bt(t,e,n){var i=yt(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function hn(t,e){return function(){return bt(this,t,e)}}function dn(t,e){return function(){return bt(this,t,e.apply(this,arguments))}}function pn(t,e){return this.each((typeof e=="function"?dn:hn)(t,e))}function*mn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,a;r<s;++r)(a=i[r])&&(yield a)}var gn=[null];function Y(t,e){this._groups=t,this._parents=e}function yn(){return this}Y.prototype={constructor:Y,select:Pt,selectAll:Vt,selectChild:Zt,selectChildren:Qt,filter:jt,data:se,enter:te,exit:ae,join:le,merge:ce,selection:yn,order:ue,sort:fe,call:de,nodes:pe,node:me,size:ge,empty:ye,each:_e,attr:Se,style:Fe,property:Oe,classed:qe,text:ze,html:Xe,raise:Ze,lower:Ke,append:Je,insert:je,remove:en,clone:sn,datum:on,on:fn,dispatch:pn,[Symbol.iterator]:mn};function At(t){return typeof t=="string"?new Y([document.querySelectorAll(t)],[document.documentElement]):new Y([pt(t)],gn)}const _n=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function wn(t){const e=window.getComputedStyle(t,null).getPropertyValue("font-size");return parseFloat(e)}function vn(t){return t.r*.299+t.g*.587+t.b*.114}function xn(t){return vn(t)>165}function bn(t){return xn(m.color(t))?"black":"white"}function $t(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${e}${n}${i}`}function I(t,e){return"translate("+t+","+e+")"}function An(){document.querySelectorAll('g.task[class*=" --"]').forEach(function(e){e.style.display="none"})}function St(t,e,n){const r=m.select(t).attr("class");let s=!1;e.selectAll("g.row").each(function(g){const _=m.select(this).attr("class");if(_==r)s=!0;else if(s){let d=this.getAttribute("transform"),h=parseFloat(d.split("(")[1].split(",")[0].trim()),f=parseFloat(d.split(",")[1].split(")")[0].trim());this.setAttribute("transform",`translate(${h},${f+n})`);var v=_.split(" ")[1];document.querySelectorAll(`g.task.${v} rect`).forEach(function(y){y.setAttribute("y",parseFloat(y.getAttribute("y"))+n)}),document.querySelectorAll(`g.task.${v} text`).forEach(function(y){y.setAttribute("y",parseFloat(y.getAttribute("y"))+n)})}});const a=document.querySelector('path[stroke-width="1.75"]');let c=a.getAttribute("d").match(/M([\d.-]+),([\d.-]+)V([\d.-]+)/),o=parseFloat(c[1]),u=parseFloat(c[2]),S=parseFloat(c[3])+n;a.setAttribute("d",`M${o},${u}V${S}`);const b=document.querySelector("g.x.axis.bottom-axis");let E=b.getAttribute("transform").match(/translate\(([\d.-]+),([\d.-]+)\)/),A=parseFloat(E[1]),C=parseFloat(E[2]);b.setAttribute("transform",`translate(${A},${C+n})`)}function $n(t,e){e.forEach(function(i){document.querySelectorAll(`g.row.${i}`).forEach(function(s){s.style.display="block"})});const n=m.select(t).attr("class").split(" ")[1];m.selectAll(`g.task.${n}`).each(function(i){var r=i[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(r==n.replace(/--/g,""))m.select(this).style("display","none");else if(r!=n.replace(/--/g,"")){m.select(this).style("display","block");var s=(e.indexOf(r)+1)*38;let a=m.select(this),l=a.attr("transform"),c=parseFloat(l.split("(")[1].split(",")[0].trim()),o=parseFloat(l.split(",")[1].split(")")[0].trim()),u=o+s;a.attr("transform",`translate(${c}, ${o})`).transition().duration(1e3).attr("transform",`translate(${c}, ${u})`).on("start",()=>{At(`g.task.${r}`).style("display","none")}).on("end",()=>{a.style("display","none"),a.attr("transform",`translate(${c}, ${o})`),At(`g.task.${r}`).style("display","block")})}})}function Sn(t,e){return new Promise(n=>{const i=m.select(t).attr("class").split(" ")[1];m.selectAll(`g.task:not(.${i})`).each(function(r){var s=r[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(e.includes(s)){m.select(this).style("display","block");var a=(e.indexOf(s)+1)*38;let l=m.select(this),c=l.attr("transform"),o=parseFloat(c.split("(")[1].split(",")[0].trim()),u=parseFloat(c.split(",")[1].split(")")[0].trim()),p=u-a;l.transition().duration(1e3).attr("transform",`translate(${o}, ${p})`).on("end",()=>{m.selectAll(`g.${i}`).style("display","block"),l.style("display","none"),l.attr("transform",`translate(${o}, ${u})`),e.forEach(function(S){document.querySelectorAll(`.${S}`).forEach(function(M){M.style.display="none"})}),n()})}})})}function kt(t,e){const i=m.select(t).attr("class"),r=[];let s=!1,a=!1;return e.selectAll("g.row").each(function(l){const o=m.select(this).attr("class");o==i?s=!0:s&&o.split(" ")[2]=="timelineheader"?a=!0:s&&!a&&r.push(o.split(" ")[1])}),r}function kn(){let t=_n,e=5,n=2,i=!1,r=!1,s,a,l=0,c=Z(0),o=Z(1),u=Z(2),p=Z(3);function S(g,w){const _=g.select("text"),v=g.select("rect"),d=v.attr("width")-2*e,h=o(w);_.text(h);let f=_.node().getComputedTextLength();if(f>d){const x=d<0?0:d/f,k=Math.floor(h.length*x);_.text(k>2?h.slice(0,k-2)+"â€¦":"")}}function b(g,w,_){const v=g.select("text").node(),d=v.getBBox(),h=_.scale().domain().indexOf(c(w)),f=_.colorscale()(h),x=g.selectAll("rect.bckg").data([w]).join("rect").attr("class","bckg").attr("fill",f).attr("x",d.x-e+n).attr("y",d.y-2).attr("width",d.width+e-n).attr("height",d.height);g.node().insertBefore(x.node(),v)}function M(g,w){g.each(function(_,v){const d=m.select(this.parentNode);p(_)-u(_)?S(d,_):b(d,_,w)})}function E(g){return function(w,_){m.active(this).tween("text",function(){return function(v){M(m.select(this),g)}})}}function A(g){const w=g.datum(),_=new Set(m.map(w,c)),v=new J(C),d=m.scaleOrdinal(t);s=s||[m.min(w,u),m.max(w,p)],r&&(s=m.extent(s.concat(new Date))),g.each(function(h){const f=a||this.getBoundingClientRect().width,x=_.size*(wn(this)+4*e),k=m.scaleBand().domain(_).range([0,x]),y=m.scaleTime().domain(s),F=(i?it:rt)(k).width(f),D=m.select(this).selectAll("svg").data([1]).join("svg");D.attr("class","timeline").attr("width",f).attr("height",x+40);const T=D.append("g").attr("transform","translate(0,20)"),O=T.append("g").attr("class","y axis").call(F);O.selectAll("text").attr("text-anchor",function($){return $.startsWith(" â€¢")?"middle":"end"}).attr("x",function($){return $.startsWith(" â€¢")?167:332.5}).style("cursor","pointer").style("font-weight",function($){return $.startsWith(" â€¢")?"bold":"normal"}).style("background","none").on("click",function($,B){const H=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${B.replace(/ â€¢ /g,"").replace(" ","%20")}%22`;window.open(H,"_blank")}),O.selectAll("g.row").each(function($){const B=m.select(this).datum();m.select(this).classed(m.select(this).datum().replace(/â€¢/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,""),!0),B.startsWith(" â€¢")&&m.select(this).classed("timelineheader",!0).append("text").attr("x",320.5).attr("y",25).text("-").style("text-anchor","end").style("cursor","pointer").style("font-size","30px").attr("fill","black").style("-ms-user-select","none").style("-webkit-user-select","none").style("user-select","none")}),O.selectAll("g.row.timelineheader text").on("click",function($,B){const X=m.select(this).text();if(X==="+"){let P=kt(this.parentNode,O),H=P.length*38;$n(this.parentNode,P),St(this.parentNode,O,H),m.select(this).text()==="+"?m.select(this).text("-").style("font-size","30px"):m.select(this).text("+")}else if(X==="-"){let P=kt(this.parentNode,O),H=P.length*38;Sn(this.parentNode,P).then(()=>{St(this.parentNode,O,-H)}),m.select(this).text()==="-"?m.select(this).text("+").style("font-size","20px"):m.select(this).text("-")}else{const U=`https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22${B.replace(/ â€¢ /g,"").replace(" ","%20")}%22`;window.open(U,"_blank")}});let R=F.range();y.range([R[0]+e,R[1]-e]).clamp(!0);const W=m.axisBottom(y),q=T.append("g").attr("class","x axis").attr("transform",I(0,0)).call(W);q.selectAll(".tick text").attr("dy","-1.5em"),q.selectAll(".tick line").attr("y2","-5");const Mn=m.axisBottom(y);D.append("g").attr("class","x axis bottom-axis").attr("transform",I(0,x+20)).call(Mn).selectAll(".tick line").attr("y2","5"),O.on("offset",()=>{R=F.range(),y.range([R[0]+e,R[1]-e]).clamp(!0),W.ticks(Math.min((R[1]-R[0])/70,10)),q.call(W),z.attr("transform",$=>I(y(u($)),k(c($)))).selectAll("rect").attr("width",$=>y(p($))-y(u($))||n).call($=>M($,F)),O.call(F.draw_ticks,y.ticks().map(y))}),q.select(".domain").remove(),q.selectAll(".tick line").attr("stroke","#AAA");const Cn=y.ticks().map(y);O.call(F.draw_ticks,Cn);let z=T.selectAll("g.task").data(h);z.exit().remove();const et=z.enter().append("g").classed("task",!0);et.each(function($){const B=c($).replace(/â€¢/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");m.select(this).classed(B,!0)}).append("rect").style("opacity",1).attr("y",e).style("cursor","pointer").attr("height",k.bandwidth()-2*e).on("mouseover",v.show).on("mouseout",v.hide).on("click",function($,B){var X=String(B[1]),P=X.replace(" ","%20"),H=B[2],U=$t(H),Fn=B[3],En=$t(Fn),Dn="https://www.primarysourcecoop.org/publications/jqa/search#q%3D%2Bsubject%3A%22"+P+"%22%20%2Bdate_when%3A%5B"+U+"%20TO%20"+En+"%5D%7Crows=20%7Cstart=0%7Chl=true%7Chl.fl=text_merge%7Csort=date_when%20asc%7Cff=person_keyword;subject%7Cfl=id%20index%20title%20filename%20resource_group_name%20date_when%20date_to%20author%20recipient%20person_keyword%20subject%20doc_beginning";window.open(Dn,"_blank")}).style("fill",Q(o,d)),et.append("text").attr("text-anchor","start").attr("fill",$=>p($)-u($)?Q(o,d,bn)($):"black").attr("pointer-events","none").attr("dx",e).attr("y",k.bandwidth()/2).attr("dy","0.32em").text(o),z=z.merge(et),z.attr("transform",$=>I(R[0],k(c($)))).selectAll("rect").attr("width",0),z.transition().duration(l).attr("transform",$=>I(y(u($)),k(c($)))).selectAll("rect").attr("width",$=>y(p($))-y(u($))||n).on("start",E(F)),r&&T.append("path").attr("stroke","red").attr("d","M"+y(new Date)+",0.5V"+x)}),An()}return A.dates=function(g){return arguments.length?(s=g,A):s},A.width=function(g){return arguments.length?(a=g,A):a},A.today=function(g){return arguments.length?(r=g,A):r},A.colors=function(g){return arguments.length?(t=g,A):t},A.padding=function(g){return arguments.length?(e=g,A):e},A.milestone_width=function(g){return arguments.length?(n=g,A):n},A.reversed=function(g){return arguments.length?(i=g,A):i},A.duration=function(g){return arguments.length?(l=g,A):l},A;function C(g,w){const _=Q(m.isoParse,m.timeFormat("%Y-%m-%d")),v=`<b>${o(w)}</b><hr style="margin: 2px 0 2px 0">${_(u(w))}`,d=p(w)-u(w)?` - ${_(p(w))}<br>${ct(u(w),p(w))}`:"";return v+d}}N.durationFormat=ct,N.timeline=kn,N.timelineAxisLeft=rt,N.timelineAxisRight=it,N.tooltip=J,Object.keys(L).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(N,t)&&Object.defineProperty(N,t,{enumerable:!0,get:()=>L[t]})}),Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})});
