(function(N,z){typeof exports=="object"&&typeof module<"u"?z(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],z):(N=typeof globalThis<"u"?globalThis:N||self,z(N.d3=N.d3||{},N.d3,N.dayjs))})(this,function(N,z,et){"use strict";function Ot(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:()=>t[n]})}}return e.default=t,Object.freeze(e)}const d=Ot(z),Yt="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function nt(t){d.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(Yt);const e=d.select("body").append("div").attr("class","tooltip").style("opacity",0);return e.show=function(n){e.transition().duration(100).style("opacity",.95),e.html(t.apply(null,arguments)).style("left",n.pageX+"px").style("top",n.pageY-28+"px")},e.hide=function(n){e.transition().duration(100).style("opacity",0)},e}function Pt(t){return d.max(t.nodes().map(e=>e.getComputedTextLength()))}function Rt(t){return function(e){return e.length>t?e.slice(0,t-1)+"â€¦":e}}const V=1,Ht=2;function ct(t,e){let n=["#FFF","#FFF"],r=d.scaleOrdinal(n),s=5,i,o="#AAA",a=40,c=3e3,l;function f(p){let x=e.domain(),b=nt(y=>y),S=d.scaleOrdinal(n),C=d.scaleOrdinal(n.reverse()),D=Rt(a),_=p.selectAll(".row").data(x,e).order(),F=_.enter().append("g").attr("class","row"),g=_.exit(),w=_.select("text");_=_.merge(F).attr("transform",y=>"translate(0,"+e(y)+")"),g.remove(),F.append("rect").attr("y",.5).attr("width",c).attr("height",e.bandwidth()).attr("stroke",o).attr("stroke-width",.75).attr("fill",S),F.append("path").attr("stroke",C),w=w.merge(F.append("text").attr("y",e.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(y,m){d.select(this).text()!=m&&b.show(m)}).on("mouseout",b.hide)).text(D),l===void 0&&(l=Pt(w)+2*s,l=t===V?c-l:l),i=t===V?[0,l]:[l,c],w.attr("text-anchor",t===V?"start":"end").attr("dx",t===V?s:-s).attr("x",l),p.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",o).attr("stroke-width",1.75).attr("d","M"+(l+.5)+",0.5V"+e.range()[1])}return f.draw_ticks=function(p,x){p.selectAll(".row").select("path").attr("d",x.map(b=>"M"+b+",1v"+(e.bandwidth()-1)).join(""))},f.scale=function(p){return arguments.length?(e=p,f):e},f.width=function(p){return arguments.length?(c=p,f):c},f.colors=function(p){return arguments.length?(n=p,f):n},f.padding=function(p){return arguments.length?(s=p,f):s},f.range=function(p){return arguments.length?(i=p,f):i},f.trim=function(p){return arguments.length?(a=p,f):a},f.offset=function(p){return arguments.length?(l=p,f):l},f.colorscale=function(p){return arguments.length?(r=p,f):r},f}function ut(t){return ct(Ht,t)}function ft(t){return ct(V,t)}var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function dt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pt={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ht,function(){var n,r,s=1e3,i=6e4,o=36e5,a=864e5,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=31536e6,f=2628e6,p=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,x={years:l,months:f,days:a,hours:o,minutes:i,seconds:s,milliseconds:1,weeks:6048e5},b=function(m){return m instanceof w},S=function(m,h,u){return new w(m,u,h.$l)},C=function(m){return r.p(m)+"s"},D=function(m){return m<0},_=function(m){return D(m)?Math.ceil(m):Math.floor(m)},F=function(m){return Math.abs(m)},g=function(m,h){return m?D(m)?{negative:!0,format:""+F(m)+h}:{negative:!1,format:""+m+h}:{negative:!1,format:""}},w=function(){function m(u,A,M){var v=this;if(this.$d={},this.$l=M,u===void 0&&(this.$ms=0,this.parseFromMilliseconds()),A)return S(u*x[C(A)],this);if(typeof u=="number")return this.$ms=u,this.parseFromMilliseconds(),this;if(typeof u=="object")return Object.keys(u).forEach(function(T){v.$d[C(T)]=u[T]}),this.calMilliseconds(),this;if(typeof u=="string"){var k=u.match(p);if(k){var E=k.slice(2).map(function(T){return T!=null?Number(T):0});return this.$d.years=E[0],this.$d.months=E[1],this.$d.weeks=E[2],this.$d.days=E[3],this.$d.hours=E[4],this.$d.minutes=E[5],this.$d.seconds=E[6],this.calMilliseconds(),this}}return this}var h=m.prototype;return h.calMilliseconds=function(){var u=this;this.$ms=Object.keys(this.$d).reduce(function(A,M){return A+(u.$d[M]||0)*x[M]},0)},h.parseFromMilliseconds=function(){var u=this.$ms;this.$d.years=_(u/l),u%=l,this.$d.months=_(u/f),u%=f,this.$d.days=_(u/a),u%=a,this.$d.hours=_(u/o),u%=o,this.$d.minutes=_(u/i),u%=i,this.$d.seconds=_(u/s),u%=s,this.$d.milliseconds=u},h.toISOString=function(){var u=g(this.$d.years,"Y"),A=g(this.$d.months,"M"),M=+this.$d.days||0;this.$d.weeks&&(M+=7*this.$d.weeks);var v=g(M,"D"),k=g(this.$d.hours,"H"),E=g(this.$d.minutes,"M"),T=this.$d.seconds||0;this.$d.milliseconds&&(T+=this.$d.milliseconds/1e3,T=Math.round(1e3*T)/1e3);var H=g(T,"S"),O=u.negative||A.negative||v.negative||k.negative||E.negative||H.negative,Bt=k.format||E.format||H.format?"T":"",tt=(O?"-":"")+"P"+u.format+A.format+v.format+Bt+k.format+E.format+H.format;return tt==="P"||tt==="-P"?"P0D":tt},h.toJSON=function(){return this.toISOString()},h.format=function(u){var A=u||"YYYY-MM-DDTHH:mm:ss",M={Y:this.$d.years,YY:r.s(this.$d.years,2,"0"),YYYY:r.s(this.$d.years,4,"0"),M:this.$d.months,MM:r.s(this.$d.months,2,"0"),D:this.$d.days,DD:r.s(this.$d.days,2,"0"),H:this.$d.hours,HH:r.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:r.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:r.s(this.$d.seconds,2,"0"),SSS:r.s(this.$d.milliseconds,3,"0")};return A.replace(c,function(v,k){return k||String(M[v])})},h.as=function(u){return this.$ms/x[C(u)]},h.get=function(u){var A=this.$ms,M=C(u);return M==="milliseconds"?A%=1e3:A=M==="weeks"?_(A/x[M]):this.$d[M],A||0},h.add=function(u,A,M){var v;return v=A?u*x[C(A)]:b(u)?u.$ms:S(u,this).$ms,S(this.$ms+v*(M?-1:1),this)},h.subtract=function(u,A){return this.add(u,A,!0)},h.locale=function(u){var A=this.clone();return A.$l=u,A},h.clone=function(){return S(this.$ms,this)},h.humanize=function(u){return n().add(this.$ms,"ms").locale(this.$l).fromNow(!u)},h.valueOf=function(){return this.asMilliseconds()},h.milliseconds=function(){return this.get("milliseconds")},h.asMilliseconds=function(){return this.as("milliseconds")},h.seconds=function(){return this.get("seconds")},h.asSeconds=function(){return this.as("seconds")},h.minutes=function(){return this.get("minutes")},h.asMinutes=function(){return this.as("minutes")},h.hours=function(){return this.get("hours")},h.asHours=function(){return this.as("hours")},h.days=function(){return this.get("days")},h.asDays=function(){return this.as("days")},h.weeks=function(){return this.get("weeks")},h.asWeeks=function(){return this.as("weeks")},h.months=function(){return this.get("months")},h.asMonths=function(){return this.as("months")},h.years=function(){return this.get("years")},h.asYears=function(){return this.as("years")},m}(),y=function(m,h,u){return m.add(h.years()*u,"y").add(h.months()*u,"M").add(h.days()*u,"d").add(h.hours()*u,"h").add(h.minutes()*u,"m").add(h.seconds()*u,"s").add(h.milliseconds()*u,"ms")};return function(m,h,u){n=u,r=u().$utils(),u.duration=function(v,k){var E=u.locale();return S(v,{$l:E},k)},u.isDuration=b;var A=h.prototype.add,M=h.prototype.subtract;h.prototype.add=function(v,k){return b(v)?y(this,v,1):A.bind(this)(v,k)},h.prototype.subtract=function(v,k){return b(v)?y(this,v,-1):M.bind(this)(v,k)}}})})(pt);var qt=pt.exports;const zt=dt(qt);var mt={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(ht,function(){return function(n,r,s){n=n||{};var i=r.prototype,o={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a(l,f,p,x){return i.fromToBase(l,f,p,x)}s.en.relativeTime=o,i.fromToBase=function(l,f,p,x,b){for(var S,C,D,_=p.$locale().relativeTime||o,F=n.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],g=F.length,w=0;w<g;w+=1){var y=F[w];y.d&&(S=x?s(l).diff(p,y.d,!0):p.diff(l,y.d,!0));var m=(n.rounding||Math.round)(Math.abs(S));if(D=S>0,m<=y.r||!y.r){m<=1&&w>0&&(y=F[w-1]);var h=_[y.l];b&&(m=b(""+m)),C=typeof h=="string"?h.replace("%d",m):h(m,f,y.l,D);break}}if(f)return C;var u=D?_.future:_.past;return typeof u=="function"?u(C):u.replace("%s",C)},i.to=function(l,f){return a(l,f,this,!0)},i.from=function(l,f){return a(l,f,this)};var c=function(l){return l.$u?s.utc():s()};i.toNow=function(l){return this.to(c(this),l)},i.fromNow=function(l){return this.from(c(this),l)}}})})(mt);var Lt=mt.exports;const Vt=dt(Lt);et.extend(zt),et.extend(Vt);function gt(t,e){return et.duration(e-t).humanize()}function rt(){const t=Array.prototype.slice.call(arguments,0);return function(e){return t.reduce((n,r)=>r(n),e)}}function G(t){return function(e){return t===void 0?e:e[t]}}var st="http://www.w3.org/1999/xhtml";const yt={svg:"http://www.w3.org/2000/svg",xhtml:st,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function _t(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),yt.hasOwnProperty(e)?{space:yt[e],local:t}:t}function It(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===st&&e.documentElement.namespaceURI===st?e.createElement(t):e.createElementNS(n,t)}}function Wt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function wt(t){var e=_t(t);return(e.local?Wt:It)(e)}function Xt(){}function xt(t){return t==null?Xt:function(){return this.querySelector(t)}}function Ut(t){typeof t!="function"&&(t=xt(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,a=r[s]=new Array(o),c,l,f=0;f<o;++f)(c=i[f])&&(l=t.call(c,c.__data__,f,i))&&("__data__"in c&&(l.__data__=c.__data__),a[f]=l);return new B(r,this._parents)}function vt(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Zt(){return[]}function Gt(t){return t==null?Zt:function(){return this.querySelectorAll(t)}}function Kt(t){return function(){return vt(t.apply(this,arguments))}}function Jt(t){typeof t=="function"?t=Kt(t):t=Gt(t);for(var e=this._groups,n=e.length,r=[],s=[],i=0;i<n;++i)for(var o=e[i],a=o.length,c,l=0;l<a;++l)(c=o[l])&&(r.push(t.call(c,c.__data__,l,o)),s.push(c));return new B(r,s)}function Qt(t){return function(){return this.matches(t)}}function At(t){return function(e){return e.matches(t)}}var jt=Array.prototype.find;function te(t){return function(){return jt.call(this.children,t)}}function ee(){return this.firstElementChild}function ne(t){return this.select(t==null?ee:te(typeof t=="function"?t:At(t)))}var re=Array.prototype.filter;function se(){return Array.from(this.children)}function ie(t){return function(){return re.call(this.children,t)}}function oe(t){return this.selectAll(t==null?se:ie(typeof t=="function"?t:At(t)))}function le(t){typeof t!="function"&&(t=Qt(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var i=e[s],o=i.length,a=r[s]=[],c,l=0;l<o;++l)(c=i[l])&&t.call(c,c.__data__,l,i)&&a.push(c);return new B(r,this._parents)}function bt(t){return new Array(t.length)}function ae(){return new B(this._enter||this._groups.map(bt),this._parents)}function K(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}K.prototype={constructor:K,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ce(t){return function(){return t}}function ue(t,e,n,r,s,i){for(var o=0,a,c=e.length,l=i.length;o<l;++o)(a=e[o])?(a.__data__=i[o],r[o]=a):n[o]=new K(t,i[o]);for(;o<c;++o)(a=e[o])&&(s[o]=a)}function fe(t,e,n,r,s,i,o){var a,c,l=new Map,f=e.length,p=i.length,x=new Array(f),b;for(a=0;a<f;++a)(c=e[a])&&(x[a]=b=o.call(c,c.__data__,a,e)+"",l.has(b)?s[a]=c:l.set(b,c));for(a=0;a<p;++a)b=o.call(t,i[a],a,i)+"",(c=l.get(b))?(r[a]=c,c.__data__=i[a],l.delete(b)):n[a]=new K(t,i[a]);for(a=0;a<f;++a)(c=e[a])&&l.get(x[a])===c&&(s[a]=c)}function he(t){return t.__data__}function de(t,e){if(!arguments.length)return Array.from(this,he);var n=e?fe:ue,r=this._parents,s=this._groups;typeof t!="function"&&(t=ce(t));for(var i=s.length,o=new Array(i),a=new Array(i),c=new Array(i),l=0;l<i;++l){var f=r[l],p=s[l],x=p.length,b=pe(t.call(f,f&&f.__data__,l,r)),S=b.length,C=a[l]=new Array(S),D=o[l]=new Array(S),_=c[l]=new Array(x);n(f,p,C,D,_,b,e);for(var F=0,g=0,w,y;F<S;++F)if(w=C[F]){for(F>=g&&(g=F+1);!(y=D[g])&&++g<S;);w._next=y||null}}return o=new B(o,r),o._enter=a,o._exit=c,o}function pe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function me(){return new B(this._exit||this._groups.map(bt),this._parents)}function ge(t,e,n){var r=this.enter(),s=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(s=e(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function ye(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,s=n.length,i=r.length,o=Math.min(s,i),a=new Array(s),c=0;c<o;++c)for(var l=n[c],f=r[c],p=l.length,x=a[c]=new Array(p),b,S=0;S<p;++S)(b=l[S]||f[S])&&(x[S]=b);for(;c<s;++c)a[c]=n[c];return new B(a,this._parents)}function _e(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],s=r.length-1,i=r[s],o;--s>=0;)(o=r[s])&&(i&&o.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(o,i),i=o);return this}function we(t){t||(t=xe);function e(p,x){return p&&x?t(p.__data__,x.__data__):!p-!x}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var o=n[i],a=o.length,c=s[i]=new Array(a),l,f=0;f<a;++f)(l=o[f])&&(c[f]=l);c.sort(e)}return new B(s,this._parents).order()}function xe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ve(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ae(){return Array.from(this)}function be(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length;s<i;++s){var o=r[s];if(o)return o}return null}function $e(){let t=0;for(const e of this)++t;return t}function ke(){return!this.node()}function Se(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var s=e[n],i=0,o=s.length,a;i<o;++i)(a=s[i])&&t.call(a,a.__data__,i,s);return this}function Me(t){return function(){this.removeAttribute(t)}}function Ee(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ce(t,e){return function(){this.setAttribute(t,e)}}function Fe(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ne(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function De(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Te(t,e){var n=_t(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Ee:Me:typeof e=="function"?n.local?De:Ne:n.local?Fe:Ce)(n,e))}function $t(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Be(t){return function(){this.style.removeProperty(t)}}function Oe(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ye(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Pe(t,e,n){return arguments.length>1?this.each((e==null?Be:typeof e=="function"?Ye:Oe)(t,e,n??"")):Re(this.node(),t)}function Re(t,e){return t.style.getPropertyValue(e)||$t(t).getComputedStyle(t,null).getPropertyValue(e)}function He(t){return function(){delete this[t]}}function qe(t,e){return function(){this[t]=e}}function ze(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Le(t,e){return arguments.length>1?this.each((e==null?He:typeof e=="function"?ze:qe)(t,e)):this.node()[t]}function kt(t){return t.trim().split(/^|\s+/)}function it(t){return t.classList||new St(t)}function St(t){this._node=t,this._names=kt(t.getAttribute("class")||"")}St.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Mt(t,e){for(var n=it(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function Et(t,e){for(var n=it(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function Ve(t){return function(){Mt(this,t)}}function Ie(t){return function(){Et(this,t)}}function We(t,e){return function(){(e.apply(this,arguments)?Mt:Et)(this,t)}}function Xe(t,e){var n=kt(t+"");if(arguments.length<2){for(var r=it(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof e=="function"?We:e?Ve:Ie)(n,e))}function Ue(){this.textContent=""}function Ze(t){return function(){this.textContent=t}}function Ge(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Ke(t){return arguments.length?this.each(t==null?Ue:(typeof t=="function"?Ge:Ze)(t)):this.node().textContent}function Je(){this.innerHTML=""}function Qe(t){return function(){this.innerHTML=t}}function je(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function tn(t){return arguments.length?this.each(t==null?Je:(typeof t=="function"?je:Qe)(t)):this.node().innerHTML}function en(){this.nextSibling&&this.parentNode.appendChild(this)}function nn(){return this.each(en)}function rn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function sn(){return this.each(rn)}function on(t){var e=typeof t=="function"?t:wt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ln(){return null}function an(t,e){var n=typeof t=="function"?t:wt(t),r=e==null?ln:typeof e=="function"?e:xt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function cn(){var t=this.parentNode;t&&t.removeChild(this)}function un(){return this.each(cn)}function fn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function hn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function dn(t){return this.select(t?hn:fn)}function pn(t){return arguments.length?this.property("__data__",t):this.node().__data__}function mn(t){return function(e){t.call(this,e,this.__data__)}}function gn(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function yn(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,s=e.length,i;n<s;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function _n(t,e,n){return function(){var r=this.__on,s,i=mn(e);if(r){for(var o=0,a=r.length;o<a;++o)if((s=r[o]).type===t.type&&s.name===t.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=e;return}}this.addEventListener(t.type,i,n),s={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(s):this.__on=[s]}}function wn(t,e,n){var r=gn(t+""),s,i=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,l=a.length,f;c<l;++c)for(s=0,f=a[c];s<i;++s)if((o=r[s]).type===f.type&&o.name===f.name)return f.value}return}for(a=e?_n:yn,s=0;s<i;++s)this.each(a(r[s],e,n));return this}function Ct(t,e,n){var r=$t(t),s=r.CustomEvent;typeof s=="function"?s=new s(e,n):(s=r.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function xn(t,e){return function(){return Ct(this,t,e)}}function vn(t,e){return function(){return Ct(this,t,e.apply(this,arguments))}}function An(t,e){return this.each((typeof e=="function"?vn:xn)(t,e))}function*bn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],s=0,i=r.length,o;s<i;++s)(o=r[s])&&(yield o)}var $n=[null];function B(t,e){this._groups=t,this._parents=e}function kn(){return this}B.prototype={constructor:B,select:Ut,selectAll:Jt,selectChild:ne,selectChildren:oe,filter:le,data:de,enter:ae,exit:me,join:ge,merge:ye,selection:kn,order:_e,sort:we,call:ve,nodes:Ae,node:be,size:$e,empty:ke,each:Se,attr:Te,style:Pe,property:Le,classed:Xe,text:Ke,html:tn,raise:nn,lower:sn,append:on,insert:an,remove:un,clone:dn,datum:pn,on:wn,dispatch:An,[Symbol.iterator]:bn};function Ft(t){return typeof t=="string"?new B([document.querySelectorAll(t)],[document.documentElement]):new B([vt(t)],$n)}var J=0,I=0;const Sn=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function Mn(t){const e=window.getComputedStyle(t,null).getPropertyValue("font-size");return parseFloat(e)}function En(t){return t.r*.299+t.g*.587+t.b*.114}function Cn(t){return En(t)>165}function Fn(t){return Cn(d.color(t))?"black":"white"}function Nt(t){const e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}${n}${r}`}function W(t,e){return"translate("+t+","+e+")"}function Nn(){document.querySelectorAll('g.task[class*=" --"]').forEach(function(e){e.style.display="none"})}function Q(t,e,n){const s=d.select(t).attr("class");let i=!1;e.selectAll("g.row").each(function(F){const w=d.select(this).attr("class");if(w==s)i=!0;else if(i){let m=this.getAttribute("transform"),h=parseFloat(m.split("(")[1].split(",")[0].trim()),u=parseFloat(m.split(",")[1].split(")")[0].trim());this.setAttribute("transform",`translate(${h},${u+n})`);var y=w.split(" ")[1];document.querySelectorAll(`g.task.${y} rect`).forEach(function(v){v.setAttribute("y",parseFloat(v.getAttribute("y"))+n)}),document.querySelectorAll(`g.task.${y} text`).forEach(function(v){v.setAttribute("y",parseFloat(v.getAttribute("y"))+n)})}});const o=document.querySelector('path[stroke-width="1.75"]');let c=o.getAttribute("d").match(/M([\d.-]+),([\d.-]+)V([\d.-]+)/),l=parseFloat(c[1]),f=parseFloat(c[2]),x=parseFloat(c[3])+n;o.setAttribute("d",`M${l},${f}V${x}`);const b=d.select("g.x.axis.bottom-axis");let S=b.attr("transform"),C=parseFloat(S.split("(")[1].split(",")[0].trim()),_=parseFloat(S.split(",")[1].split(")")[0].trim())+n;b.attr("transform",`translate(${C}, ${_})`)}function Dt(t,e){e.forEach(function(r){document.querySelectorAll(`g.row.${r}`).forEach(function(i){i.style.display="block"})});const n=d.select(t).attr("class").split(" ")[1];d.selectAll(`g.task.${n}`).each(function(r){var s=r[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(s==n.replace(/--/g,""))d.select(this).style("display","none");else if(s!=n.replace(/--/g,"")){d.select(this).style("display","block");var i=(e.indexOf(s)+1)*38;let o=d.select(this),a=o.attr("transform"),c=parseFloat(a.split("(")[1].split(",")[0].trim()),l=parseFloat(a.split(",")[1].split(")")[0].trim()),f=l+i;o.attr("transform",`translate(${c}, ${l})`).transition().duration(1e3).attr("transform",`translate(${c}, ${f})`).on("start",()=>{Ft(`g.task.${s}`).style("display","none")}).on("end",()=>{o.style("display","none"),o.attr("transform",`translate(${c}, ${l})`),Ft(`g.task.${s}`).style("display","block")})}})}function Tt(t,e){return new Promise(n=>{const r=d.select(t).attr("class").split(" ")[1];d.selectAll(`g.task:not(.${r})`).each(function(s){var i=s[1].replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");if(e.includes(i)){d.select(this).style("display","block");var o=(e.indexOf(i)+1)*38;let a=d.select(this),c=a.attr("transform"),l=parseFloat(c.split("(")[1].split(",")[0].trim()),f=parseFloat(c.split(",")[1].split(")")[0].trim()),p=f-o;a.transition().duration(1e3).attr("transform",`translate(${l}, ${p})`).on("end",()=>{d.selectAll(`g.${r}`).style("display","block"),a.style("display","none"),a.attr("transform",`translate(${l}, ${f})`),e.forEach(function(x){document.querySelectorAll(`.${x}`).forEach(function(S){S.style.display="none"})}),n()})}})})}function j(t,e){const r=d.select(t).attr("class"),s=[];let i=!1,o=!1;return e.selectAll("g.row").each(function(a){const l=d.select(this).attr("class");l==r?i=!0:i&&l.split(" ")[2]=="timelineheader"?o=!0:i&&!o&&s.push(l.split(" ")[1])}),s}function Dn(){const t=document.getElementById("collapseAllButton");t.disabled=!0;let e=[];d.selectAll("g.row.timelineheader text").each(function(){if(d.select(this).text()==="-"){const r=this.parentNode,s=j(r,d.select(r.parentNode)),i=s.length*38;let o=Tt(r,s).then(()=>{Q(r,d.select(r.parentNode),-i),d.select(this).text("+").style("font-size","20px")});e.push(o)}}),Promise.all(e).then(()=>{t.disabled=!1})}window.collapseAll=Dn;function Tn(){const t=document.getElementById("expandAllButton");t.disabled=!0;let e=[];d.selectAll("g.row.timelineheader text").each(function(){if(d.select(this).text()==="+"){const r=this.parentNode,s=j(r,d.select(r.parentNode)),i=s.length*38;let o=new Promise(a=>{Dt(r,s),Q(r,d.select(r.parentNode),i),a()}).then(()=>{d.select(this).text("-").style("font-size","30px")});e.push(o)}}),Promise.all(e).then(()=>{t.disabled=!1})}window.expandAll=Tn;function Bn(t){let e=Sn,n=5,r=2,s=!1,i=!1,o,a,c=0,l=G(0),f=G(1),p=G(2),x=G(3);console.log(t);function b(g,w){const y=g.select("text"),m=g.select("rect"),h=m.attr("width")-2*n,u=f(w);y.text(u);let A=y.node().getComputedTextLength();if(A>h){const M=h<0?0:h/A,v=Math.floor(u.length*M);y.text(v>2?u.slice(0,v-2)+"â€¦":"")}}function S(g,w,y){const m=g.select("text").node(),h=m.getBBox(),u=y.scale().domain().indexOf(l(w)),A=y.colorscale()(u),M=g.selectAll("rect.bckg").data([w]).join("rect").attr("class","bckg").attr("fill",A).attr("x",h.x-n+r).attr("y",h.y-2).attr("width",h.width+n-r).attr("height",h.height);g.node().insertBefore(M.node(),m)}function C(g,w){g.each(function(y,m){const h=d.select(this.parentNode);x(y)-p(y)?b(h,y):S(h,y,w)})}function D(g){return function(w,y){d.active(this).tween("text",function(){return function(m){C(d.select(this),g)}})}}function _(g){const w=g.datum(),y=new Set(d.map(w,l)),m=new nt(F),h=d.scaleOrdinal(e);o=o||[d.min(w,p),d.max(w,x)],i&&(o=d.extent(o.concat(new Date))),g.each(function(u){const A=a||this.getBoundingClientRect().width,M=y.size*(Mn(this)+4*n),v=d.scaleBand().domain(y).range([0,M]),k=d.scaleTime().domain(o),E=(s?ft:ut)(v).width(A),T=d.select(this).selectAll("svg").data([1]).join("svg");T.attr("class","timeline").attr("width",A).attr("height",M+40);const H=T.append("g").attr("transform","translate(0,20)"),O=H.append("g").attr("class","y axis").call(E);let On=document.querySelector('path[stroke-width="1.75"]').getAttribute("d").match(/M([\d.-]+),([\d.-]+)V([\d.-]+)/),ot=parseFloat(On[1]);O.selectAll("text").on("mouseover",function(){d.select(this).style("text-decoration","underline")}).on("mouseout",function(){d.select(this).style("text-decoration","none")}).attr("text-anchor",function($){return $.startsWith(" â€¢")?"middle":"end"}).attr("x",function($){return $.startsWith(" â€¢")?ot/2:ot-.5}).style("cursor","pointer").style("font-weight",function($){return $.startsWith(" â€¢")?"bold":"normal"}).style("background","none").on("click",function($,Y){const P=Y.replace(/ â€¢ /g,"").replace(" ","%20"),R=`https://www.primarysourcecoop.org/publications/${t}/search#q%3D%2Bsubject%3A%22${P}%22`;window.open(R,"_blank")}),O.selectAll("g.row").each(function($){const Y=d.select(this).datum();d.select(this).classed(d.select(this).datum().replace(/â€¢/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,""),!0),Y.startsWith(" â€¢")&&d.select(this).classed("timelineheader",!0).append("text").attr("x",ot-10).attr("y",25).text("-").style("text-anchor","end").style("cursor","pointer").style("font-size","30px").attr("fill","black").style("-ms-user-select","none").style("-webkit-user-select","none").style("user-select","none")}),O.selectAll("g.row.timelineheader text").on("click",function($,Y){const U=d.select(this).text();if(U==="+"){J-=1,I+=1,console.log("Collapsed: ",J),console.log("Expanded: ",I);let P=j(this.parentNode,O),R=P.length*38;Dt(this.parentNode,P),Q(this.parentNode,O,R),d.select(this).text()==="+"?d.select(this).text("-").style("font-size","30px"):d.select(this).text("+")}else if(U==="-"){J+=1,I-=1,console.log("Collapsed: ",J),console.log("Expanded: ",I);let P=j(this.parentNode,O),R=P.length*38;Tt(this.parentNode,P).then(()=>{Q(this.parentNode,O,-R)}),d.select(this).text()==="-"?d.select(this).text("+").style("font-size","20px"):d.select(this).text("-")}else{const R=Y.replace(/ â€¢ /g,"").replace(" ","%20"),Z=`https://www.primarysourcecoop.org/publications/${t}/search#q%3D%2Bsubject%3A%22${R}%22`;window.open(Z,"_blank")}}),I=d.selectAll("text").filter(function(){return this.textContent.startsWith(" â€¢")}).size();let q=E.range();k.range([q[0]+n,q[1]-n]).clamp(!0);const lt=d.axisBottom(k),X=H.append("g").attr("class","x axis").attr("transform",W(0,0)).call(lt);X.selectAll(".tick text").attr("dy","-1.5em"),X.selectAll(".tick line").attr("y2","-5");const Yn=d.axisBottom(k);T.append("g").attr("class","x axis bottom-axis").attr("transform",W(0,M+20)).call(Yn).selectAll(".tick line").attr("y2","5"),O.on("offset",()=>{q=E.range(),k.range([q[0]+n,q[1]-n]).clamp(!0),lt.ticks(Math.min((q[1]-q[0])/70,10)),X.call(lt),L.attr("transform",$=>W(k(p($)),v(l($)))).selectAll("rect").attr("width",$=>k(x($))-k(p($))||r).call($=>C($,E)),O.call(E.draw_ticks,k.ticks().map(k))}),X.select(".domain").remove(),X.selectAll(".tick line").attr("stroke","#AAA");const Pn=k.ticks().map(k);O.call(E.draw_ticks,Pn);let L=H.selectAll("g.task").data(u);L.exit().remove();const at=L.enter().append("g").classed("task",!0);at.each(function($){const Y=l($).replace(/â€¢/g,"").replace(/ /g,"-").replace(/[^a-zA-Z0-9-]/g,"");d.select(this).classed(Y,!0)}).append("rect").style("opacity",1).attr("y",n).style("cursor","pointer").attr("height",v.bandwidth()-2*n).on("mouseover",m.show).on("mouseout",m.hide).on("click",function($,Y){var U=String(Y[1]),P=U.replace(" ","%20"),R=Y[2],Z=Nt(R),Rn=Y[3],Hn=Nt(Rn),qn="https://www.primarysourcecoop.org/publications/"+t+"/search#q%3D%2Bsubject%3A%22"+P+"%22%20%2Bdate_when%3A%5B"+Z+"%20TO%20"+Hn+"%5D%7Crows=20%7Cstart=0%7Chl=true%7Chl.fl=text_merge%7Csort=date_when%20asc%7Cff=person_keyword;subject%7Cfl=id%20index%20title%20filename%20resource_group_name%20date_when%20date_to%20author%20recipient%20person_keyword%20subject%20doc_beginning";window.open(qn,"_blank")}).style("fill",rt(f,h)),at.append("text").attr("text-anchor","start").attr("fill",$=>x($)-p($)?rt(f,h,Fn)($):"black").attr("pointer-events","none").attr("dx",n).attr("y",v.bandwidth()/2).attr("dy","0.32em").text(f),L=L.merge(at),L.attr("transform",$=>W(q[0],v(l($)))).selectAll("rect").attr("width",0),L.transition().duration(c).attr("transform",$=>W(k(p($)),v(l($)))).selectAll("rect").attr("width",$=>k(x($))-k(p($))||r).on("start",D(E)),i&&H.append("path").attr("stroke","red").attr("d","M"+k(new Date)+",0.5V"+M)}),Nn()}return _.dates=function(g){return arguments.length?(o=g,_):o},_.width=function(g){return arguments.length?(a=g,_):a},_.today=function(g){return arguments.length?(i=g,_):i},_.colors=function(g){return arguments.length?(e=g,_):e},_.padding=function(g){return arguments.length?(n=g,_):n},_.milestone_width=function(g){return arguments.length?(r=g,_):r},_.reversed=function(g){return arguments.length?(s=g,_):s},_.duration=function(g){return arguments.length?(c=g,_):c},_;function F(g,w){const y=rt(d.isoParse,d.timeFormat("%Y-%m-%d")),m=`<b>${f(w)}</b><hr style="margin: 2px 0 2px 0">${y(p(w))}`,h=x(w)-p(w)?` - ${y(x(w))}<br>${gt(p(w),x(w))}`:"";return m+h}}N.durationFormat=gt,N.timeline=Bn,N.timelineAxisLeft=ut,N.timelineAxisRight=ft,N.tooltip=nt,Object.keys(z).forEach(t=>{t!=="default"&&!Object.prototype.hasOwnProperty.call(N,t)&&Object.defineProperty(N,t,{enumerable:!0,get:()=>z[t]})}),Object.defineProperty(N,Symbol.toStringTag,{value:"Module"})});
